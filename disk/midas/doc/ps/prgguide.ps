%!PS-Adobe-2.0
%%Creator: dvipsk 5.58f Copyright 1986, 1994 Radical Eye Software
%%Title: prgguide.dvi
%%Pages: 32
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Times-Roman Times-Bold Symbol Courier Times-Italic
%%DocumentPaperSizes: A4
%%EndComments
%DVIPSCommandLine: dvips -t a4 -o prgguide.ps prgguide
%DVIPSParameters: dpi=600, comments removed
%DVIPSSource:  TeX output 1998.03.01:2226
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginFont: Times-Roman
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def
%%EndFont
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (prgguide.dvi)
@start /Fa 134[44 1[66 44 50 28 39 39 1[50 50 50 72 28
44 1[28 50 50 28 44 50 44 50 50 8[61 83 61 72 55 50 61
1[61 72 66 83 55 2[33 72 72 61 61 72 66 61 61 10[50 4[50
3[33 3[33 33 37[50 2[{ TeXBase1Encoding ReEncodeFont }49
100.000003 /Times-Italic rf /Fb 133[53 60 60 86 60 66
40 47 53 1[66 60 66 100 33 66 1[33 66 60 40 53 66 53
66 60 9[120 86 86 80 66 2[73 93 86 113 80 2[47 1[93 73
80 86 86 80 86 1[60 5[60 1[60 60 60 60 60 60 60 1[33
30 40 45[{ TeXBase1Encoding ReEncodeFont }54 119.999948
/Times-Bold rf /Fc 130[51 1[51 51 51 51 51 51 51 51 51
51 51 51 51 51 51 51 51 1[51 51 51 51 51 51 51 51 51
1[51 2[51 3[51 51 51 51 51 51 51 1[51 51 51 51 51 1[51
51 51 51 51 51 51 51 51 51 2[51 51 51 51 51 51 51 51
51 51 51 51 51 51 51 51 51 51 51 51 1[51 51 51 51 2[51
51 51 33[{ .85 ExtendFont TeXBase1Encoding ReEncodeFont }78
100.000003 /Courier rf /Fd 256[{}0 100.000003 /Symbol
rf /Fe 133[64 72 72 104 1[80 48 56 64 1[80 72 80 120
40 80 1[40 80 72 48 64 80 64 80 72 9[143 1[104 1[80 2[88
112 1[135 96 2[56 3[96 104 104 1[104 1[72 7[72 72 72
72 72 72 72 2[36 48 42[80 2[{ TeXBase1Encoding ReEncodeFont }46
143.999997 /Times-Bold rf /Ff 166[72 2[72 72 61 55 66
1[55 72 72 89 61 2[33 72 72 55 61 72 66 1[72 11[50 50
50 50 3[25 46[{ .167 SlantFont TeXBase1Encoding ReEncodeFont }24
100.000003 /Times-Roman rf /Fg 64[44 29[33 9[100 50 1[44
44 24[44 50 50 72 50 50 28 39 33 50 50 50 50 78 28 50
28 28 50 50 33 44 50 44 50 44 6[61 72 72 94 72 72 61
55 66 72 55 72 72 89 61 72 39 33 72 72 55 61 72 66 66
72 1[44 1[56 2[28 50 50 50 50 50 50 50 50 50 50 28 25
33 25 56 50 33 33 33 1[83 3[33 29[55 55 2[{
 TeXBase1Encoding ReEncodeFont }84 100.000003 /Times-Roman
rf /Fh 134[50 50 72 50 55 33 39 44 1[55 50 55 83 28 55
1[28 55 50 33 44 55 44 55 50 6[66 72 1[100 72 72 66 55
72 1[61 78 72 94 66 2[39 78 78 61 66 72 72 66 72 7[50
50 50 1[50 50 50 50 50 50 2[33 25 10[33 30[55 2[{
 TeXBase1Encoding ReEncodeFont }58 100.000003 /Times-Bold
rf /Fi 134[103 2[103 115 69 80 92 1[115 103 115 172 57
2[57 115 103 69 92 115 92 1[103 11[149 1[115 3[161 1[195
3[80 1[161 2[149 149 1[149 11[103 103 103 103 103 46[115
2[{ TeXBase1Encoding ReEncodeFont }34 207.333362 /Times-Bold
rf /Fj 139[33 47 40 1[60 1[60 93 33 2[33 60 60 1[53 1[53
1[53 16[66 2[106 1[86 17[60 60 6[60 4[30 44[{
 TeXBase1Encoding ReEncodeFont }20 119.999948 /Times-Roman
rf /Fk 134[86 3[86 48 67 57 2[86 1[134 48 2[48 1[86 1[76
86 2[76 13[96 2[96 2[153 3[57 1[124 2[124 2[124 25[57
39[{ TeXBase1Encoding ReEncodeFont }21 172.833377 /Times-Roman
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 952 2165 a Fk(MID)-7 b(AS)44 b(Digital)f(Audio)h(System)1279
2580 y(Programmer')-9 b(s)44 b(Guide)1512 3111 y Fj(Petteri)31
b(Kang)o(aslampi)1648 3493 y(March)f(1,)g(1998)p eop
%%Page: 1 2
1 1 bop 109 1220 a Fi(Contents)109 1855 y Fh(1)99 b(Intr)n(oduction)
3041 b(1)258 2059 y Fg(1.1)104 b(W)-8 b(elcome)94 b(.)50
b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)168 b(1)258 2262 y(1.2)104 b(What)25 b(is)f(MID)l(AS?)74
b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168
b(1)109 2565 y Fh(2)99 b(Getting)25 b(started)2936 b(2)258
2768 y Fg(2.1)104 b(Installing)24 b(MID)l(AS)48 b(.)i(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168 b(2)258 2972
y(2.2)104 b(Compiling)23 b(with)h(MID)l(AS)96 b(.)50
b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168 b(2)258
3175 y(2.3)104 b(Linking)24 b(with)g(MID)l(AS)57 b(.)50
b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168
b(3)487 3379 y(2.3.1)119 b(W)l(indo)n(ws)23 b(NT/95)86
b(.)50 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168 b(3)487
3582 y(2.3.2)119 b(MS-DOS)72 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)168 b(4)487 3785 y(2.3.3)119
b(Linux)60 b(.)50 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)168 b(4)258 3989 y(2.4)104 b(Using)24 b(MID)l(AS)h(from)g
(the)f(IDE)80 b(.)49 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168
b(4)487 4192 y(2.4.1)119 b(Using)24 b(MID)l(AS)h(with)f(V)-6
b(isual)24 b(C)h(De)n(v)o(eloper)f(Studio)69 b(.)49 b(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168 b(5)487 4396 y(2.4.2)119
b(Using)24 b(MID)l(AS)h(with)f(W)-8 b(atcom)24 b(C)i(IDE)75
b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)168 b(5)258 4599 y(2.5)104 b(A)25 b(simple)f(module)f(player)i
(e)o(xample)43 b(.)50 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168 b(6)487
4803 y(2.5.1)119 b(C)25 b(module)f(player)h(e)o(xample)95
b(.)50 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)f(.)h(.)g(.)g(.)f(.)168 b(6)487 5006 y(2.5.2)119
b(Delphi)24 b(module)g(player)h(e)o(xample)39 b(.)50
b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)168 b(7)487 5209 y(2.5.3)119 b(Module)24
b(player)h(e)o(xample)f(description)80 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168 b(7)1985
5943 y(i)p eop
%%Page: 2 3
2 2 bop 109 208 a Ff(CONTENTS)3204 b Fg(ii)109 473 y
Fh(3)99 b(Using)25 b(MID)m(AS)f(Digital)g(A)-5 b(udio)25
b(System)2061 b(9)258 676 y Fg(3.1)104 b(Initializing)23
b(and)i(con\002guring)f(MID)l(AS)83 b(.)49 b(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)168
b(9)258 880 y(3.2)104 b(Uninitializing)23 b(MID)l(AS)96
b(.)49 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(10)258 1083 y(3.3)104 b(Using)24 b(modules)91 b(.)49
b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(10)487 1287 y(3.3.1)g(Loading)24 b(and)h(deallocating)f(modules)43
b(.)49 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)119 b(10)487 1490 y(3.3.2)g(Playing)24 b(modules)79
b(.)50 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(11)487
1693 y(3.3.3)g(Controlling)23 b(module)h(playback)k(.)49
b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)119 b(11)487 1897 y(3.3.4)g(Getting)24
b(module)g(information)76 b(.)49 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(11)258 2100 y(3.4)104 b(Using)24 b(samples)33 b(.)50
b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(12)487 2304 y(3.4.1)g(Loading)24 b(samples)68 b(.)50
b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(12)487
2507 y(3.4.2)g(Playing)24 b(samples)96 b(.)50 b(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)119 b(12)487 2710 y(3.4.3)g(Samples)25
b(and)f(channels)91 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(13)487 2914 y(3.4.4)g(Controlling)23 b(sample)i(playback)44
b(.)49 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)119 b(13)487 3117 y(3.4.5)g(Getting)24
b(sample)g(information)93 b(.)49 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(13)258 3321 y(3.5)104 b(Using)24 b(streams)50 b(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(14)258
3524 y(3.6)104 b(Playing)25 b(streams)58 b(.)49 b(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(14)487
3727 y(3.6.1)g(Controlling)23 b(stream)i(playback)61
b(.)49 b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)f(.)h(.)g(.)g(.)f(.)119 b(15)487 3931 y(3.6.2)g(Getting)24
b(stream)g(information)35 b(.)50 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(15)258 4134 y(3.7)104 b(Using)24 b(echo)h(ef)n(fects)j(.)50
b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(15)487 4338 y(3.7.1)g(Adding)24 b(echo)h(ef)n(fects)97
b(.)49 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(15)487
4541 y(3.7.2)g(The)25 b(echo)g(ef)n(fect)g(structure)55
b(.)50 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(16)109 4844 y Fh(4)99
b(Adv)o(anced)26 b(topics)2832 b(17)258 5047 y Fg(4.1)104
b(Optimizing)23 b(MID)l(AS)i(performance)41 b(.)50 b(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)119 b(17)487 5251 y(4.1.1)g(The)25 b(number)f(of)h(channels)80
b(.)50 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(17)487 5454 y(4.1.2)g(Sample)25
b(types)63 b(.)50 b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(18)487 5658 y(4.1.3)g(Output)24 b(settings)65 b(.)49
b(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(19)p
eop
%%Page: 3 4
3 3 bop 109 208 a Ff(CONTENTS)3176 b Fg(iii)258 473 y(4.2)104
b(Using)24 b(-la)o(w)h(compression)97 b(.)50 b(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)119 b(19)487 676 y(4.2.1)g(Encoding)24
b(-la)o(w)g(samples)42 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(20)487 880 y(4.2.2)g(Using)24 b(-la)o(w)g(samples)37
b(.)50 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(20)258
1083 y(4.3)104 b(Using)24 b(ADPCM)h(compression)69 b(.)49
b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(20)487 1287
y(4.3.1)g(Encoding)24 b(ADPCM)h(streams)30 b(.)50 b(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
119 b(20)487 1490 y(4.3.2)g(Using)24 b(ADPCM)h(streams)99
b(.)50 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(21)109 1793 y Fh(5)99
b(Operating)25 b(system)g(speci\002c)h(inf)n(ormation)1914
b(22)258 1996 y Fg(5.1)104 b(Using)24 b(DirectSound)75
b(.)50 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(22)487 2200 y(5.1.1)g(Initialization)87 b(.)50 b(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(22)487 2403 y(5.1.2)g(DirectSound)25
b(modes)32 b(.)50 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(23)487 2607 y(5.1.3)g(Buf)n(fer)25 b(sizes)47 b(.)j(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(23)487 2810
y(5.1.4)g(Using)24 b(other)h(DirectSound)f(services)h(with)f(MID)l(AS)
57 b(.)49 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(24)487 3013 y(5.1.5)g(When)25 b(to)f(use)h(DirectSound?)50
b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(24)487 3217 y(5.1.6)g(DirectSound)25
b(and)f(multiple)f(windo)n(ws)81 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(25)258
3420 y(5.2)104 b(MS-DOS)26 b(timer)e(callbacks)58 b(.)50
b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(25)487
3624 y(5.2.1)g(Introduction)29 b(.)50 b(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
f(.)h(.)g(.)g(.)f(.)119 b(25)487 3827 y(5.2.2)g(Using)24
b(timer)g(callbacks)k(.)49 b(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(26)487 4030 y(5.2.3)g(Synchronizing)24 b(to)g(display)g(refresh)48
b(.)i(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)119 b(26)487 4234 y(5.2.4)g(The)25 b(callback)g
(functions)62 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119
b(27)487 4437 y(5.2.5)g(Framerate)26 b(control)35 b(.)50
b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)119 b(28)p
eop
%%Page: 1 5
1 4 bop 109 1220 a Fi(Chapter)51 b(1)109 1718 y(Intr)l(oduction)-57
2316 y Fe(1.1)142 b(W)-9 b(elcome)109 2623 y Fg(W)h(elcome)36
b(to)h(the)f(e)o(xciting)f(w)o(orld)i(of)g(digital)e(audio!)66
b(MID)l(AS)37 b(Digital)f(Audio)f(System)i(is)f(the)g(most)109
2743 y(comprehensi)n(v)o(e)28 b(cross-platform)i(digital)f(audio)h
(system)g(today)-6 b(.)47 b(W)l(ith)30 b(features)h(such)f(as)h(an)f
(unlimited)109 2863 y(number)20 b(of)g(digital)f(channels)i(on)f(all)g
(supported)f(platforms,)i(simultaneous)d(sample,)j(module)e(and)i
(stream)109 2984 y(playback,)i(and)g(seamless)f(portability)g(across)h
(operating)f(systems,)g(MID)l(AS)i(is)e(all)h(you)g(need)g(for)h
(perfect)109 3104 y(sound)g(in)g(your)h(applications.)109
3307 y(This)k(manual)g(is)g(the)g(Programmer')-5 b(s)30
b(Guide)f(to)g(the)h(MID)l(AS)f(Digital)g(Audio)g(System.)45
b(It)29 b(includes)g(de-)109 3428 y(scriptions)c(about)h(all)h(aspects)
g(of)g(MID)l(AS,)g(including)e(initialization,)g(con\002guration)i(and)
f(usage)h(of)g(dif-)109 3548 y(ferent)33 b(system)f(components.)55
b(It)33 b(does)g(not)g(attempt)f(to)h(document)f(all)h(functions)f(and)
i(data)f(structures)109 3669 y(a)n(v)n(ailable)24 b(in)i(MID)l(AS,)f(b)
n(ut)g(rather)h(gi)n(v)o(e)e(a)i(good)f(o)o(v)o(ervie)n(w)f(on)h(ho)n
(w)g(you)g(can)h(use)f(MID)l(AS)h(in)f(your)g(o)n(wn)109
3789 y(programs.)50 b(F)o(or)31 b(complete)g(descriptions)f(of)i(all)f
(function)f(and)i(data)f(structures,)i(see)f(the)f(MID)l(AS)h(API)109
3909 y(reference.)-57 4332 y Fe(1.2)142 b(What)36 b(is)g(MID)-5
b(AS?)109 4638 y Fg(What)24 b(is)h(MID)l(AS)g(Digital)e(Audio)h(System)
h(an)o(yw)o(ay?)109 4842 y(MID)l(AS)20 b(Digital)f(Audio)h(System)g(is)
g(a)g(multichannel)f(digital)g(music)h(and)g(sound)f(engine.)29
b(It)21 b(pro)o(vides)e(you)109 4962 y(with)31 b(an)h(unlimited)d
(number)j(of)f(channels)h(of)g(digital)e(audio)h(that)h(you)f(can)h
(use)g(to)f(play)h(music,)g(sound)109 5083 y(ef)n(fects,)24
b(speech)h(or)g(sound)f(streams.)30 b(MID)l(AS)24 b(is)h(portable)f
(across)h(a)g(wide)f(range)h(of)g(operating)f(systems,)109
5203 y(and)g(pro)o(vides)f(an)i(identical)e(API)i(in)f(all)g(supported)
f(en)l(vironments,)g(making)h(it)f(ideal)i(for)f(cross-platform)109
5323 y(softw)o(are)h(de)n(v)o(elopment.)109 5527 y(MID)l(AS)h(Digital)f
(Audio)h(System)g(is)g(free)h(for)f(noncommercial)g(usage,)g(read)h
(the)f(\002le)h Fc(license.txt)e Fg(in-)109 5647 y(cluded)c(in)h(the)f
(MID)l(AS)h(distrib)n(ution)d(for)k(a)f(detailed)f(license.)29
b(Commercial)22 b(licenses)f(are)i(also)e(a)n(v)n(ailable.)1974
5943 y(1)p eop
%%Page: 2 6
2 5 bop 109 1217 a Fi(Chapter)51 b(2)109 1713 y(Getting)g(started)109
2246 y Fg(Although)28 b(MID)l(AS)h(Digital)g(Audio)f(System)h(is)g(a)h
(v)o(ery)f(po)n(werful)g(sound)g(engine,)h(it)f(is)g(also)g(e)o
(xtremely)109 2366 y(easy)j(to)f(use.)51 b(This)31 b(chapter)h
(contains)f(all)h(the)f(information)g(necessary)h(to)f(de)n(v)o(elop)g
(simple)f(sound)h(ap-)109 2487 y(plications)25 b(using)g(MID)l(AS.)h
(It)h(describes)f(ho)n(w)f(to)h(link)g(MID)l(AS)g(into)f(your)h(o)n(wn)
g(programs,)g(ho)n(w)f(to)h(use)109 2607 y(the)33 b(MID)l(AS)h(API)g
(functions)e(from)i(your)f(o)n(wn)g(code,)j(and)d(concludes)g(with)g(a)
h(simple)f(module)f(player)109 2727 y(program)24 b(e)o(xample.)-57
3144 y Fe(2.1)142 b(Installing)34 b(MID)-5 b(AS)109 3448
y Fg(Installing)28 b(MID)l(AS)h(Digital)f(Audio)h(System)g(is)g(v)o
(ery)g(simple:)38 b(just)28 b(create)j(a)e(separate)h(directory)f(for)h
(it,)109 3569 y(and)23 b(decompress)g(the)g(distrib)n(ution)e(archi)n
(v)o(e.)30 b(MID)l(AS)24 b(is)f(normally)f(distrib)n(uted)g(as)h(one)h
(or)f(se)n(v)o(eral)g Fc(.zip)109 3689 y Fg(\002les,)g(and)g(the)o(y)f
(all)h(need)g(to)f(be)h(decompressed)g(in)f(the)h(same)g(directory)-6
b(.)29 b(If)23 b(de)n(v)o(eloping)e(W)l(in32)h(or)h(Linux)109
3809 y(applications,)g(use)h(an)h(unzip)f(utility)e(that)i(handles)g
(long)g(\002lenames,)g(such)g(as)h(InfoZip)f(unzip)g(or)g(W)l(inZip,)
109 3930 y(instead)32 b(of)h(MS-DOS)h(pkunzip.)55 b(Linux)32
b(de)n(v)o(elopers)g(should)g(decompress)h(the)g(\002les)g(in)g(Linux,)
h(as)f(the)109 4050 y(archi)n(v)o(e)24 b(may)g(contain)g(symbolic)g
(links)f(for)i(the)g(Linux)f(libraries.)109 4251 y Fh(Note!)45
b Fg(Mak)o(e)30 b(sure)g(your)f(unzip)g(utility)f(decompresses)h
(subdirectories)g(correctly)-6 b(.)45 b(InfoZip)29 b(unzip)g(and)109
4371 y(W)l(inZip)24 b(should)f(do)i(this)f(by)g(def)o(ault,)h(b)n(ut)f
(pkunzip)g(needs)g(the)h(\223)p Fc(-d)p Fg(\224)g(option)f(to)g(do)h
(this.)-57 4788 y Fe(2.2)142 b(Compiling)34 b(with)h(MID)-5
b(AS)109 5092 y Fg(F)o(or)28 b(applications)f(using)h(just)g(the)g(MID)
l(AS)h(Digital)e(Audio)h(System)g(API,)h(no)f(special)h(compilation)d
(op-)109 5213 y(tions)j(are)i(necessary)-6 b(.)48 b(All)30
b(MID)l(AS)h(API)g(de\002nitions)f(are)h(in)f(the)g(\002le)h
Fc(midasdll.h)p Fg(,)g(and)f(the)h(modules)109 5333 y(using)38
b(MID)l(AS)i(functions)e(simply)g(need)i(to)f Fc(#include)f
Fg(this)h(\002le.)75 b(No)40 b(special)f(macros)g(need)h(to)f(be)109
5453 y Fc(#define)p Fg(d,)27 b(and)h(the)f(data)h(structures)g(are)g
(structure-packing)f(neutral.)40 b Fc(midasdll.h)26 b
Fg(is)h(located)h(in)f(the)109 5574 y Fc(include/)g Fg(subdirectory)i
(of)g(the)g(MID)l(AS)g(distrib)n(ution,)f(and)h(you)f(may)h(need)g(to)g
(add)g(that)g(directory)g(to)109 5694 y(your)24 b(include)g(\002le)i
(search)f(path.)1974 5943 y(2)p eop
%%Page: 3 7
3 6 bop 109 208 a Ff(CHAPTER)25 b(2.)56 b(GETTING)24
b(ST)-9 b(AR)j(TED)2231 b Fg(3)109 473 y(Under)35 b(W)l(indo)n(ws)g
(NT/95,)i(the)f(MID)l(AS)f(API)i(functions)d(use)i(the)f
Fc(stdcall)g Fg(calling)g(con)l(v)o(ention,)h(the)109
593 y(same)28 b(as)g(used)h(by)f(the)g(W)l(in32)g(API.)h(Under)f(DOS,)h
(the)f(functions)f(use)i(the)f Fc(cdecl)f Fg(calling)h(con)l(v)o
(ention,)109 714 y(and)e(under)g(Linux)g(the)g(def)o(ault)g(calling)f
(con)l(v)o(ention)g(used)h(by)g(GCC.)h(This)f(is)g(done)g
(transparently)g(to)f(the)109 834 y(user)l(,)f(ho)n(we)n(v)o(er)-5
b(.)109 1037 y(Delphi)37 b(users)i(can)g(simply)d(use)j(the)f(interf)o
(ace)h(unit)f Fc(midasdll.pas)p Fg(,)h(and)g(access)g(the)f(MID)l(AS)h
(API)109 1158 y(functions)31 b(through)h(it.)53 b(Although)31
b(Delphi)h(syntax)g(is)g(dif)n(ferent)g(from)g(C,)h(the)g(function,)g
(structure)f(and)109 1278 y(constant)27 b(names)h(are)h(e)o(xactly)e
(the)h(same,)h(and)f(all)g(parameters)g(are)h(passed)f(just)f(lik)o(e)g
(in)h(the)g(C)h(v)o(ersions.)109 1399 y(Therefore)c(all)g(information)e
(in)i(this)e(document)h(and)h(the)g(API)g(Reference)i(is)d(also)h(v)n
(alid)e(for)i(Delphi.)109 1602 y(MS-DOS)i(users)g(with)g(W)-8
b(atcom)27 b(C)g(will)g(need)g(to)g(disable)f(the)h(\223SS==DS\224)j
(assumption)25 b(from)i(the)g(mod-)109 1722 y(ules)j(that)g(contain)g
(MID)l(AS)g(callback)h(functions.)47 b(This)30 b(can)h(be)f(done)h
(with)e(the)i(\223)p Fc(-zu)p Fg(\224)f(command)g(line)109
1843 y(option.)f(Note)c(that)f(this)g(is)g Fh(not)i Fg(necessary)f(for)
g(code)g(that)f(just)g(calls)g(MID)l(AS)h(functions.)-57
2265 y Fe(2.3)142 b(Linking)35 b(with)g(MID)-5 b(AS)109
2572 y Fg(If)21 b(your)g(program)g(uses)g(MID)l(AS)g(Digital)f(Audio)h
(System,)g(you)g(naturally)f(need)i(to)e(link)h(with)f(the)h(MID)l(AS)
109 2692 y(libraries)j(as)h(well.)30 b(This)24 b(section)g(describes)h
(ho)n(w)f(to)g(do)h(that)f(on)h(each)g(platform)f(supported.)109
2896 y(All)29 b(MID)l(AS)i(Digital)e(Audio)g(System)h(libraries)g(are)h
(stored)f(under)g(the)h Fc(lib/)e Fg(subdirectory)h(in)g(the)g(dis-)109
3016 y(trib)n(ution.)41 b Fc(lib/)28 b Fg(contains)g(a)h(subdirectory)f
(for)h(each)g(supported)f(platform,)h(and)g(those)f(in)g(turn)h
(contain)109 3136 y(directories)d(for)g(each)h(supported)e(compiler)-5
b(.)34 b(The)26 b(format)g(of)h(the)f(compiler)f(directory)h(names)g
(is)g(\223\241com-)109 3257 y(piler\277\241b)n(uild\277\224,)c(where)i
(\241compiler\277)f(is)f(a)i(tw)o(o-letter)e(abbre)n(viation)g(for)h
(the)g(compiler)g(name,)g(and)g(\241b)n(uild\277)109
3377 y(the)29 b(library)g(b)n(uild)f(type)h(\227)g(retail)g(or)h(deb)n
(ug.)44 b(Under)29 b(most)f(circumstances,)i(you)f(should)f(use)h(the)g
(retail)109 3498 y(v)o(ersions)21 b(of)j(the)f(libraries,)g(as)g(the)o
(y)f(contain)h(better)g(optimized)f(code.)30 b(Also,)23
b(the)g(deb)n(ug)f(libraries)h(are)h(not)109 3618 y(included)g(in)g
(all)h(releases.)109 3821 y(F)o(or)f(e)o(xample,)f Fc
(lib/win32/vcretail/midas.lib)18 b Fg(is)24 b(the)g(retail)f(b)n(uild)g
(of)h(the)g(W)l(in32)f(V)-6 b(isual)23 b(C/C++)109 3942
y(static)h(library)-6 b(.)-57 4320 y Fb(2.3.1)118 b(W)n(indo)o(ws)30
b(NT/95)109 4591 y Fg(Under)38 b(the)f(W)l(in32)g(platform,)k
(applications)36 b(can)i(link)f(with)g(MID)l(AS)h(Digital)f(Audio)g
(System)g(either)109 4711 y(statically)19 b(or)j(dynamically)-6
b(.)27 b(Unless)20 b(there)i(is)e(a)h(speci\002c)h(need)f(to)g(link)f
(with)g(MID)l(AS)h(statically)-6 b(,)20 b(dynamic)109
4831 y(linking)j(is)h(recommended.)30 b(Delphi)25 b(users)f(need)h(to)g
(use)f(dynamic)g(linking)g(al)o(w)o(ays.)109 5035 y(When)33
b(linking)f(with)h(MID)l(AS)g(statically)-6 b(,)34 b(simply)e(link)h
(with)g(the)g(library)g(\002le)h(corresponding)e(to)i(your)109
5155 y(de)n(v)o(elopment)25 b(platform.)39 b(F)o(or)28
b(W)-8 b(atcom)27 b(C/C++,)i(the)f(library)f(is)h Fc
(lib/win32/wcretail/midas.lib)p Fg(,)109 5275 y(and)j(for)g(V)-6
b(isual)31 b(C/C++)h Fc(lib/win32/vcretail/midas.lib)p
Fg(.)45 b(Depending)30 b(on)h(your)g(con\002guration,)109
5396 y(you)c(may)h(need)g(to)g(add)f(the)h(library)g(directory)g(to)f
(your)h(\223library)g(paths\224)f(list.)40 b(When)28
b(MID)l(AS)g(is)f(link)o(ed)109 5516 y(into)d(the)g(application)g
(statically)-6 b(,)23 b(the)i(.e)o(x)o(e)f(is)g(self-contained)g(and)h
(no)g(MID)l(AS)g Fc(.dll)f Fg(\002les)h(are)g(needed.)p
eop
%%Page: 4 8
4 7 bop 109 208 a Ff(CHAPTER)25 b(2.)56 b(GETTING)24
b(ST)-9 b(AR)j(TED)2231 b Fg(4)109 473 y(Dynamic)28 b(linking)f(is)h
(done)g(by)h(linking)e(with)g(the)i(appropriate)f(MID)l(AS)h(import)e
(library)i(instead)f(of)g(the)109 593 y(static)f(linking)f(library)-6
b(.)39 b(In)28 b(addition,)f(the)h(MID)l(AS)g(Dynamic)f(Link)g(Library)
h(\()p Fc(midasXX.dll)p Fg(\))e(needs)i(to)109 714 y(be)23
b(placed)h(in)f(a)h(suitable)e(directory)h(\227)g(either)h(to)f(the)g
(same)g(directory)g(with)g(the)g(program)g(e)o(x)o(ecutable,)g(or)109
834 y(in)g(some)g(directory)h(in)f(the)h(user')-5 b(s)23
b(P)-9 b(A)e(TH.)24 b(The)g(import)e(libraries)i(are)g(stored)g(in)f
(the)h(same)f(directory)h(with)109 954 y(the)f(static)g(libraries,)g(b)
n(ut)g(the)g(\002le)h(name)g(is)f Fc(midasdll.lib)p Fg(.)28
b(F)o(or)23 b(e)o(xample,)g(V)-6 b(isual)23 b(C)h(users)f(should)f
(link)109 1075 y(with)28 b Fc(lib/win32/vcretail/midasdll.lib)p
Fg(.)39 b(The)30 b(MID)l(AS)g(Dynamic)e(Link)h(Libraries)g(are)i
(stored)109 1195 y(in)24 b Fc(lib/win32/retail)e Fg(and)j
Fc(lib/win32/debug)p Fg(.)109 1399 y(Delphi)30 b(users)h(do)g(not)f
(need)i(a)f(separate)h(import)e(library)h(\227)f(using)h(the)g(interf)o
(ace)g(unit)f Fc(midasdll.pas)109 1519 y Fg(adds)d(the)h(necessary)g
(references)i(to)d(the)h Fc(.dll)f Fg(automatically)-6
b(.)38 b(Note)28 b(that)f(running)g(the)h(program)f(under)109
1639 y(the)d(Delphi)g(IDE)h(without)f(the)g Fc(.dll)g
Fg(a)n(v)n(ailable)h(can)g(cause)g(strange)f(error)i(messages.)-57
2018 y Fb(2.3.2)118 b(MS-DOS)109 2288 y Fg(As)34 b(MS-DOS)h(doesn')n(t)
f(support)g(dynamic)f(linking,)j(only)d(a)i(static)f(link)g(library)g
(is)g(pro)o(vided)f(for)i(MS-)109 2409 y(DOS.)28 b(Y)-11
b(ou')o(ll)28 b(simply)e(need)j(to)e(link)h(with)f(the)h(library)g
(from)g(the)g(appropriate)g(subdirectory)f(\227)h(usually)109
2529 y Fc(lib/dos/gcretail)18 b Fg(for)k(GCC)g(\(DJGPP\))g(and)f
Fc(lib/dos/wcretail)e Fg(for)i(W)-8 b(atcom)21 b(C.)h(The)f(e)o(x)o
(ecutable)109 2649 y(is)28 b(fully)f(self-contained,)i(and)g(no)f
(additional)f(\002les)h(are)i(needed.)41 b(DJGPP)29 b(users)g(also)f
(need)g(to)g(link)g(with)109 2770 y(the)c(Alle)o(gro)g(library)-6
b(,)24 b(as)h(MID)l(AS)g(uses)f(some)h(of)f(its)g(functions)g(for)h
(IRQ)h(handling.)109 2973 y(Note)21 b(that)h(some)f(v)o(ersions)f(of)i
(the)g(W)-8 b(atcom)21 b(Link)o(er)h(are)g(not)g(case-sensiti)n(v)o(e)e
(by)h(def)o(ault,)h(and)g(you')o(ll)f(need)109 3093 y(to)26
b(use)h(case-sensiti)n(v)o(e)f(linking)f(with)i(MID)l(AS.)g(T)-8
b(o)27 b(do)f(that,)h(simply)f(add)h Fc(option)49 b(caseexact)26
b Fg(to)h(your)109 3214 y(link)o(er)d(directi)n(v)o(es.)-57
3592 y Fb(2.3.3)118 b(Linux)109 3863 y Fg(F)o(or)38 b(Linux,)i(only)e
(a)g(static)f(library)h(is)g(pro)o(vided)f(for)h(the)g(time)f(being.)70
b(T)-8 b(o)38 b(link)g(your)f(program)h(with)109 3983
y(MID)l(AS)19 b(Digital)g(Audio)g(System,)h(add)g(the)f(proper)h
(library)f(directory)h(\(usually)e Fc(lib/linux/gcretail)p
Fg(\))109 4103 y(to)38 b(your)h(library)g(directory)f(list)g(\(gcc)i
(option)e Fc(-L)p Fg(\),)h(and)f(link)h(the)f(library)h(in)g(using)f
(the)h(GCC)h(option)109 4224 y Fc(-lmidas)p Fg(.)-57
4646 y Fe(2.4)142 b(Using)35 b(MID)-5 b(AS)35 b(fr)m(om)g(the)g(IDE)109
4953 y Fg(This)21 b(section)h(contains)g(step-by-step)g(instructions)e
(on)i(b)n(uilding)f(applications)g(that)h(use)h(MID)l(AS)f(Digital)109
5073 y(Audio)i(System)g(with)g(the)h(Inte)o(grated)f(De)n(v)o(elopent)f
(En)l(vironments)g(of)i(popular)f(compilers.)p eop
%%Page: 5 9
5 8 bop 109 208 a Ff(CHAPTER)25 b(2.)56 b(GETTING)24
b(ST)-9 b(AR)j(TED)2231 b Fg(5)-57 473 y Fb(2.4.1)118
b(Using)30 b(MID)l(AS)h(with)f(V)l(isual)g(C)h(De)n(v)o(eloper)f
(Studio)109 739 y Fg(This)23 b(section)g(contains)g(contains)g(simple)g
(step-by-step)g(instructions)e(for)k(using)d(MID)l(AS)i(Digital)f
(Audio)109 860 y(System)h(with)g(Microsoft)g(De)n(v)o(eloper)g(Studio.)
109 1059 y(1.)32 b(Be)o(gin)25 b(the)g(project)g(as)g(usual.)32
b(If)26 b(you)f(already)g(ha)n(v)o(e)g(an)h(e)o(xisting)d(project,)i
(it)g(should)f(need)i(no)f(modi\002-)109 1179 y(cations.)109
1378 y(2.)31 b(Add)25 b(some)g(simple)f(code)h(for)h(testing)e(MID)l
(AS)h(\227)g(either)g(cop)o(y)g(the)g(module)f(player)h(e)o(xample)g
(belo)n(w)-6 b(,)109 1498 y(or)24 b(just)g(add)g(a)h(call)f(to)g
Fa(MID)m(ASstartup)f Fg(to)h(the)g(be)o(ginning)f(of)h(the)h(program)f
(and)g Fc(#include)f(midasdll.h)109 1619 y Fg(at)h(the)h(be)o(ginning)e
(of)i(the)g(module.)109 1818 y(3.)k(Add)19 b(the)h(MID)l(AS)g(include)f
(directories)h(to)f(the)h(include)f(search)i(path:)27
b(Open)20 b(\223Build/Project)g(Settings\224)109 1938
y(-dialog,)40 b(choose)d(the)h(\223C/C++\224)h(tab,)i(select)c
(\223Preprocessor\224)i(from)e(the)h(Cate)o(gory)f(list,)j(and)e(add)f
(the)109 2059 y(MID)l(AS)g(include)f(directory)h(to)f(\223)-8
b(Additional)36 b(include)g(directories\224.)67 b(F)o(or)37
b(e)o(xample,)i(if)e(you)g(installed)109 2179 y(MID)l(AS)25
b(in)f Fc(d:/midas)p Fg(,)f(add)i Fc(d:/midas/include)p
Fg(.)109 2378 y(4.)35 b(Add)26 b(a)h(MID)l(AS)f(library)h(to)f(the)g
(project.)35 b(In)27 b(most)e(cases,)i(you)f(should)f(use)h(the)h
(retail)f(import)f(library)-6 b(,)109 2499 y(and)30 b(thus)g(link)g
(dynamically)-6 b(.)47 b(Open)31 b(\223Insert/Files)f(into)g
(Project\224)i(-dialog,)f(and)g(select)g(the)f(library)h(\002le)109
2619 y(you)24 b(w)o(ant)h(to)f(use,)h(typically)e Fc
(d:/midas/lib/win32/vcretail/midasdll)o(.lib)p Fg(.)109
2818 y(No)n(w)h(you)g(should)g(be)h(able)g(to)f(b)n(uild)g(the)h
(project)g(normally)-6 b(.)29 b(T)-8 b(o)25 b(be)g(able)g(to)f(run)h
(the)g(program,)f(you)g(must)109 2938 y(mak)o(e)35 b(sure)h(that)f(the)
g(MID)l(AS)h(DLL)f(is)h(a)n(v)n(ailable)e(either)i(in)f(the)g(same)h
(directory)f(with)g(the)g(produced)109 3059 y(e)o(x)o(ecutable,)23
b(or)i(in)f(some)g(directory)h(in)f(the)h(system)e(search)i(path.)31
b(Y)-11 b(ou)24 b(can)h(simply)e(cop)o(y)i(the)f(DLL)h(from)109
3179 y(\(for)g(e)o(xample\))f Fc(d:/midas/lib/win32/retail)c
Fg(to)25 b(the)f(project)h(directory)-6 b(.)-57 3548
y Fb(2.4.2)118 b(Using)30 b(MID)l(AS)h(with)f(W)-8 b(atcom)29
b(C)h(IDE)109 3815 y Fg(This)23 b(section)g(contains)g(contains)g
(simple)g(step-by-step)g(instructions)e(for)k(using)d(MID)l(AS)i
(Digital)f(Audio)109 3935 y(System)h(with)g(W)-8 b(atcom)24
b(C)i(IDE.)109 4134 y(1.)32 b(Be)o(gin)25 b(the)g(project)g(as)g
(usual.)32 b(If)26 b(you)f(already)g(ha)n(v)o(e)g(an)h(e)o(xisting)d
(project,)i(it)g(should)f(need)i(no)f(modi\002-)109 4254
y(cations.)109 4453 y(2.)31 b(Add)25 b(some)g(simple)f(code)h(for)h
(testing)e(MID)l(AS)h(\227)g(either)g(cop)o(y)g(the)g(module)f(player)h
(e)o(xample)g(belo)n(w)-6 b(,)109 4574 y(or)24 b(just)g(add)g(a)h(call)
f(to)g Fa(MID)m(ASstartup)f Fg(to)h(the)g(be)o(ginning)f(of)h(the)h
(program)f(and)g Fc(#include)f(midasdll.h)109 4694 y
Fg(at)h(the)h(be)o(ginning)e(of)i(the)g(module.)109 4893
y(3.)40 b(Add)28 b(the)g(MID)l(AS)g(include)g(directories)f(to)h(the)g
(include)f(search)i(path:)37 b(Open)28 b(\223Options/C)f(Compiler)109
5014 y(Switches\224)21 b(-dialog,)g(choose)f(\2231.)30
b(File)21 b(Option)f(Switches\224)h(from)g(the)g(switches)f(list,)g
(and)h(add)g(the)g(MID)l(AS)109 5134 y(include)27 b(directory)g(to)g
(\223Include)h(directories\224.)39 b(F)o(or)27 b(e)o(xample,)h(if)f
(you)h(installed)e(MID)l(AS)i(in)f Fc(d:/midas)p Fg(,)109
5254 y(add)d Fc(d:/midas/include)p Fg(.)109 5453 y(4.)35
b(Add)26 b(a)h(MID)l(AS)f(library)h(to)f(the)g(project.)35
b(In)27 b(most)e(cases,)i(you)f(should)f(use)h(the)h(retail)f(import)f
(library)-6 b(,)109 5574 y(and)26 b(thus)f(link)h(dynamically)-6
b(.)33 b(Open)26 b(\223Sources/Ne)n(w)g(Source\224)i(-dialog,)e(and)g
(select)g(the)g(library)g(\002le)h(you)109 5694 y(w)o(ant)d(to)h(use,)f
(typically)g Fc(d:/midas/lib/win32/wcretail/midasd)o(ll.li)o(b)p
Fg(.)p eop
%%Page: 6 10
6 9 bop 109 208 a Ff(CHAPTER)25 b(2.)56 b(GETTING)24
b(ST)-9 b(AR)j(TED)2231 b Fg(6)109 473 y(No)n(w)24 b(you)g(should)g(be)
h(able)g(to)f(b)n(uild)g(the)h(project)g(normally)-6
b(.)29 b(T)-8 b(o)25 b(be)g(able)g(to)f(run)h(the)g(program,)f(you)g
(must)109 593 y(mak)o(e)35 b(sure)h(that)f(the)g(MID)l(AS)h(DLL)f(is)h
(a)n(v)n(ailable)e(either)i(in)f(the)g(same)h(directory)f(with)g(the)g
(produced)109 714 y(e)o(x)o(ecutable,)23 b(or)i(in)f(some)g(directory)h
(in)f(the)h(system)e(search)i(path.)31 b(Y)-11 b(ou)24
b(can)h(simply)e(cop)o(y)i(the)f(DLL)h(from)109 834 y(\(for)g(e)o
(xample\))f Fc(d:/midas/lib/win32/retail)c Fg(to)25 b(the)f(project)h
(directory)-6 b(.)-57 1257 y Fe(2.5)142 b(A)36 b(simple)e(module)g
(play)o(er)g(example)109 1563 y Fg(This)24 b(section)h(describes)h(a)f
(v)o(ery)h(simple)e(e)o(xample)h(program)g(that)g(uses)g(MID)l(AS)h
(Digital)e(Audio)h(System)109 1684 y(for)c(playing)g(music.)29
b(First,)21 b(the)h(complete)f(program)g(source)g(is)g(gi)n(v)o(en)f
(in)i(both)e(C)i(and)g(Delphi)f(format,)g(and)109 1804
y(after)29 b(that)f(the)h(operation)f(of)h(the)f(program)h(is)f
(described)h(line)f(by)h(line.)42 b(T)-8 b(o)28 b(k)o(eep)h(the)g
(program)f(as)h(short)109 1924 y(as)f(possible,)f(all)h(error)h
(checking)f(is)g(omitted,)f(and)h(therefore)h(it)e(should)g(not)h(be)g
(used)g(as)g(a)h(template)e(for)109 2045 y(b)n(uilding)h(real)j
(applications)d(\227)i(the)g(other)g(e)o(xample)g(programs)f(included)h
(in)f(the)h(MID)l(AS)h(distrib)n(ution)109 2165 y(are)25
b(more)g(suitable)f(for)h(that.)109 2368 y(Both)d(v)o(ersions)f(of)h
(the)g(program)g(should)f(be)i(compiled)e(as)h(console)g(applications)f
(in)h(the)g(W)l(in32)g(en)l(viron-)109 2489 y(ment.)30
b(Under)25 b(MS-DOS)g(and)g(Linux)f(the)g(def)o(ault)h(compiler)f
(settings)f(are)j(\002ne.)-57 2867 y Fb(2.5.1)118 b(C)30
b(module)h(play)o(er)f(example)159 3138 y Fc(1)102 b(#include)49
b(<stdio.h>)159 3258 y(2)102 b(#include)49 b(<conio.h>)159
3378 y(3)102 b(#include)49 b("midasdll.h")159 3499 y(4)159
3619 y(5)102 b(int)50 b(main\(void\))159 3740 y(6)102
b({)159 3860 y(7)305 b(MIDASmodule)49 b(module;)159 3980
y(8)305 b(MIDASmodulePlayHandle)47 b(playHandle;)159
4101 y(9)109 4221 y(10)304 b(MIDASstartup\(\);)109 4341
y(11)g(MIDASinit\(\);)109 4462 y(12)g(MIDASstartBackgroundPlay\(0\);)
109 4582 y(13)109 4703 y(14)g(module)50 b(=)g
(MIDASloadModule\("..\\\\data\\\\templsun.x)o(m"\);)109
4823 y(15)304 b(playHandle)49 b(=)i(MIDASplayModule\(module,)46
b(TRUE\);)109 4943 y(16)109 5064 y(17)304 b(puts\("Playing)48
b(-)j(press)f(any)g(key"\);)109 5184 y(18)304 b(getch\(\);)109
5305 y(19)109 5425 y(20)g(MIDASstopModule\(playHandle\);)109
5545 y(21)g(MIDASfreeModule\(module\);)109 5666 y(22)p
eop
%%Page: 7 11
7 10 bop 109 208 a Ff(CHAPTER)25 b(2.)56 b(GETTING)24
b(ST)-9 b(AR)j(TED)2231 b Fg(7)109 473 y Fc(23)304 b
(MIDASstopBackgroundPlay\(\);)109 593 y(24)g(MIDASclose\(\);)109
714 y(25)109 834 y(26)g(return)50 b(0;)109 954 y(27)101
b(})-57 1328 y Fb(2.5.2)118 b(Delphi)32 b(module)e(play)o(er)h(example)
159 1596 y Fc(1)102 b(uses)50 b(midasdll;)159 1716 y(2)159
1837 y(3)102 b(var)50 b(module)g(:)g(MIDASmodule;)159
1957 y(4)102 b(var)50 b(playHandle)f(:)i(MIDASmodulePlayHandle;)159
2078 y(5)159 2198 y(6)102 b(BEGIN)159 2318 y(7)305 b(MIDASstartup;)159
2439 y(8)g(MIDASinit;)159 2559 y(9)g(MIDASstartBackgroundPlay\(0\))109
2679 y(10)109 2800 y(11)f(module)50 b(:=)g
(MIDASloadModule\('..\\data\\templsun.xm)o('\);)109 2920
y(12)304 b(playHandle)49 b(MIDASplayModule\(module,)d(true\);)109
3041 y(13)109 3161 y(14)304 b(WriteLn\('Playing)48 b(-)j(Press)e
(Enter'\);)109 3281 y(15)304 b(ReadLn;)109 3402 y(16)109
3522 y(17)g(MIDASstopModule\(playHandle\);)109 3643 y(18)g
(MIDASfreeModule\(module\);)109 3763 y(19)109 3883 y(20)g
(MIDASstopBackgroundPlay;)109 4004 y(21)g(MIDASclose;)109
4124 y(22)101 b(END.)-57 4497 y Fb(2.5.3)118 b(Module)31
b(play)o(er)f(example)g(description)109 4766 y Fg(Apart)j(from)g(minor)
f(syntax)g(dif)n(ferences,)j(the)e(C)h(and)f(Delphi)g(v)o(ersions)e(of)
j(the)f(program)f(w)o(ork)h(nearly)109 4886 y(identically)-6
b(.)29 b(This)24 b(section)g(describes)g(the)h(operation)f(of)h(the)g
(programs)f(line)g(by)h(line.)30 b(The)25 b(line)f(numbers)109
5006 y(belo)n(w)g(are)h(gi)n(v)o(en)e(in)i(pairs:)30
b(\002rst)25 b(for)g(C,)g(second)g(for)g(Delphi.)109
5297 y Fh(1-3,)f(1)49 b Fg(Includes)24 b(necessary)h(system)f(and)h
(MID)l(AS)g(de\002nition)f(\002les)109 5496 y Fh(7,)g(3)49
b Fg(De\002nes)25 b(a)g(v)n(ariable)g(for)g(the)f(module)g(that)g(will)
g(be)h(played)109 5694 y Fh(8,)f(4)49 b Fg(De\002nes)25
b(a)g(v)n(ariable)g(for)g(the)f(module)g(playing)g(handle)p
eop
%%Page: 8 12
8 11 bop 109 208 a Ff(CHAPTER)25 b(2.)56 b(GETTING)24
b(ST)-9 b(AR)j(TED)2231 b Fg(8)109 473 y Fh(10,)24 b(7)49
b Fg(Resets)29 b(the)h(MID)l(AS)f(internal)g(state)g(\227)g(This)g
(needs)g(to)g(be)h(done)f(before)h(MID)l(AS)f(is)g(con\002gured)353
593 y(and)24 b(initialized.)109 797 y Fh(11,)g(8)49 b
Fg(Initializes)24 b(MID)l(AS)109 1000 y Fh(12,)g(9)49
b Fg(Starts)25 b(playing)e(sound)h(in)h(the)f(background)109
1204 y Fh(14,)g(11)49 b Fg(Loads)24 b(the)h(module)e(\002le)109
1407 y Fh(15,)h(12)49 b Fg(Starts)24 b(playing)g(the)h(module)f(we)h
(just)f(loaded,)g(looping)f(it)109 1610 y Fh(17-18,)h(14-15)48
b Fg(Simply)24 b(w)o(aits)g(for)h(a)g(k)o(e)o(ypress)109
1814 y Fh(20,)f(17)49 b Fg(Stops)24 b(playing)g(the)g(module)109
2017 y Fh(21,)g(18)49 b Fg(Deallocates)24 b(the)h(module)f(we)h(loaded)
109 2221 y Fh(23,)f(20)49 b Fg(Stops)24 b(playing)g(sound)g(in)g(the)h
(background)109 2424 y Fh(24,)f(21)49 b Fg(Uninitializes)23
b(the)h(MID)l(AS)h(Digital)f(Audio)g(System)p eop
%%Page: 9 13
9 12 bop 109 1220 a Fi(Chapter)51 b(3)109 1718 y(Using)h(MID)-7
b(AS)52 b(Digital)i(A)-10 b(udio)51 b(System)109 2254
y Fg(This)20 b(chapter)h(contains)g(detailed)f(step-by-step)g
(instructions)g(on)g(using)g(MID)l(AS)i(Digital)e(Audio)g(System.)109
2374 y(Complete)29 b(descriptions)f(of)i(the)g(functions,)f(data)h
(structures)f(and)h(constants)f(used)g(here)h(is)g(a)n(v)n(ailable)f
(in)109 2494 y(the)24 b(API)i(reference.)-57 2917 y Fe(3.1)142
b(Initializing)34 b(and)h(con\002guring)e(MID)-5 b(AS)109
3224 y Fg(MID)l(AS)39 b(Digital)f(Audio)g(System)h(initialization)e
(consists)h(of)h(\002)n(v)o(e)g(basic)g(steps,)j(which)d(are)h
(outlined)109 3344 y(belo)n(w)-6 b(.)29 b(The)c(last)f(tw)o(o)g(steps)h
(are)g(not)f(necessary)i(in)e(all)g(cases.)109 3547 y(1.)29
b(Call)21 b Fa(MID)m(ASstartup)p Fg(.)27 b(This)19 b(should)h(be)h
(done)f(as)h(early)f(in)h(the)f(program)g(as)h(possible,)f(preferably)h
(at)f(the)109 3668 y(v)o(ery)i(be)o(ginning.)28 b Fa(MID)m(ASstartup)20
b Fg(does)i(not)g(tak)o(e)g(a)h(signi\002cant)e(amount)h(of)g(time,)g
(and)g(does)h(not)e(allocate)109 3788 y(an)o(y)30 b(memory)-6
b(,)30 b(it)h(simply)e(initializes)g(MID)l(AS)i(to)f(a)h(safe)g(and)g
(stable)f(state)g(and)h(resets)f(all)h(con\002gration)109
3909 y(options.)e(Calling)24 b Fa(MID)m(ASclose)g Fg(is)g(al)o(w)o(ays)
h(safe)g(after)h Fa(MID)m(ASstartup)c Fg(has)j(been)g(called.)109
4112 y(2.)30 b(Con\002gure)23 b(MID)l(AS.)g(This)f(can)i(be)f(done)g
(by)f(setting)g(dif)n(ferent)h(MID)l(AS)g(options)e(with)h
Fa(MID)m(ASsetOp-)109 4232 y(tion)p Fg(,)j(or)h(by)g(calling)f
Fa(MID)m(AScon\002g)g Fg(to)h(prompt)f(the)h(user)g(for)h(the)f
(settings.)33 b(The)26 b(con\002guration)f(can)i(also)109
4353 y(be)g(loaded)h(from)f(a)h(\002le)g(\(with)f Fa(MID)m
(ASloadCon\002g)p Fg(\))e(or)j(re)o(gistry)f(\(with)f
Fa(MID)m(ASr)l(eadCon\002gRe)l(gistry)p Fg(\))g(at)109
4473 y(this)e(point.)29 b(Apart)c(from)f(the)h(con\002guration)f
(functions,)g(no)g(MID)l(AS)h(functions)f(may)h(be)g(called)f(yet.)109
4676 y(3.)37 b(Initialize)26 b(MID)l(AS)h(by)g(calling)g
Fa(MID)m(ASinit)p Fg(.)35 b(All)27 b(MID)l(AS)g(functions)f(are)i
(usable)e(after)i(this,)e(and)h(the)109 4797 y(program)e(can)h(fully)f
(start)h(using)f(MID)l(AS.)h(Most)e(MID)l(AS)i(con\002guration)f
(options)g(can)h Fh(not)g Fg(be)g(changed)109 4917 y(while)d(MID)l(AS)g
(is)h(initialized,)e(so)h(to)h(change)f(the)h(options)e(it)h(is)g
(necessary)h(to)f(uninitialize)g(MID)l(AS)g(\002rst.)109
5121 y(4.)65 b(Start)36 b(background)g(sound)f(playback.)65
b(Unless)36 b(you)f(w)o(ant)h(to)g(poll)g(MID)l(AS)g(manually)f(\(with)
h Fa(MI-)109 5241 y(D)m(ASpoll)p Fg(\),)g(you)f(should)f(no)n(w)g(call)
h Fa(MID)m(ASstartBac)n(kgr)l(oundPlay)d Fg(to)j(start)f(background)h
(sound)f(play-)109 5361 y(back.)72 b Fa(MID)m(ASstartBac)n(kgr)l
(oundPlay)35 b Fg(starts)j(a)i(playback)e(thread)h(\(in)f
(multithreaded)g(systems\))f(or)i(a)109 5482 y(timer)l(,)24
b(and)h(polls)e(MID)l(AS)i(automatically)e(from)i(it.)1974
5943 y(9)p eop
%%Page: 10 14
10 13 bop 109 208 a Ff(CHAPTER)25 b(3.)56 b(USING)25
b(MID)l(AS)g(DIGIT)-9 b(AL)25 b(A)-5 b(UDIO)24 b(SYSTEM)1247
b Fg(10)109 473 y(5.)33 b(Open)25 b(sound)g(channels)g(with)g
Fa(MID)m(ASopenChannels)p Fg(.)32 b(The)26 b(number)f(of)g(open)h
(sound)f(channel)g(limits)109 593 y(the)33 b(number)f(of)h(sounds)f
(that)h(can)g(be)h(played)e(simultaneously)f(\227)i(one)g(sound)f
(channel)h(can)h(play)e(one)109 714 y(sound.)e(The)25
b(number)g(of)g(sound)f(channels)h(needed)h(depends)e(on)h(the)g
(application,)f(typical)g(v)n(alues)h(might)109 834 y(be)34
b(8\22632)g(channels)h(for)g(a)f(module,)i(one)f(channel)f(per)h
(stream)g(and)f(1\2268)g(channels)h(for)g(sound)e(ef)n(fects.)109
954 y(Ha)n(ving)24 b(more)i(channels)f(open)g(than)g(necessary)h(will)e
(not)h(increase)h(the)f(CPU)i(use,)e(as)h(inacti)n(v)o(e)e(channels)109
1075 y(do)33 b(not)g(need)h(CPU)g(attention.)56 b(Ho)n(we)n(v)o(er)l(,)
34 b(some)f(sound)g(cards)h(may)f(place)h(limitations)d(on)i(the)h
(maxi-)109 1195 y(mum)25 b(number)h(of)h(open)f(channels.)36
b(If)27 b(you)f(are)h(only)f(playing)f(a)i(single)f(module,)g(opening)f
(the)i(channels)109 1316 y(manually)c(is)i(not)f(necessary)-6
b(,)25 b(as)f Fa(MID)m(ASplayModule)g Fg(can)h(open)f(the)h(needed)g
(channels)f(automatically)-6 b(.)-57 1738 y Fe(3.2)142
b(Uninitializing)33 b(MID)-5 b(AS)109 2045 y Fg(MID)l(AS)21
b(Digital)g(Audio)f(System)h(uninitialization)e(is)i(essentially)f(the)
i(re)n(v)o(erse)f(process)g(of)h(initialization.)109
2165 y(Actually)c(only)h(the)h(last)f(step)g(is)g(\(calling)g
Fa(MID)m(ASclose)p Fg(\))g(is)g(absolutely)g(necessary)-6
b(,)20 b(b)n(ut)f(it)g(is)g(good)g(practise)109 2285
y(to)32 b(uninitialize)f(e)n(v)o(erything)g(that)i(has)f(been)h
(initialized.)54 b(In)33 b(addition,)g(all)g(modules)e(and)i(samples)f
(that)109 2406 y(ha)n(v)o(e)d(been)h(loaded)g(should)f(be)h
(deallocated)g(before)g(uninitializing)e(MID)l(AS,)i(as)g(f)o(ailing)f
(to)g(do)h(so)g(may)109 2526 y(lead)25 b(to)f(memory)g(leaks.)109
2730 y(Basic)h(MID)l(AS)g(uninitialization)d(consists)i(of)g(three)h
(steps:)109 2933 y(1.)44 b(If)30 b(sound)e(channels)i(ha)n(v)o(e)f
(been)g(opened)g(with)g Fa(MID)m(ASopenChannels)p Fg(,)g(close)g(them)g
(by)g(calling)g Fa(MI-)109 3053 y(D)m(AScloseChannels)p
Fg(.)109 3257 y(2.)h(If)c(background)e(sound)g(playback)g(is)h(used,)f
(stop)g(it)g(by)h(calling)f Fa(MID)m(ASstopBac)n(kgr)l(oundPlay)p
Fg(.)109 3460 y(3.)30 b(Finally)-6 b(,)24 b(uninitialize)f(the)i(rest)g
(of)f(MID)l(AS)h(Digital)f(Audio)g(System)g(by)h(calling)f
Fa(MID)m(ASclose)p Fg(.)-57 3883 y Fe(3.3)142 b(Using)35
b(modules)109 4189 y Fg(Digital)23 b(music)h(modules)f(pro)o(vide)h(an)
h(easy)g(to)f(use)h(and)f(space-ef)n(\002cient)h(method)f(for)h
(storing)f(music)f(and)109 4310 y(more)35 b(complicated)f(sound)h(ef)n
(fects.)62 b(MID)l(AS)35 b(Digital)f(Audio)h(System)g(supports)f
(Protrack)o(er)i(\(.mod\),)109 4430 y(Scream)28 b(T)m(rack)o(er)h(3)f
(\(.s3m\),)g(F)o(astT)m(rack)o(er)f(2)h(\(.xm\))g(and)g(Impulse)f(T)m
(rack)o(er)h(\(.it\))g(modules.)39 b(All)27 b(types)g(of)109
4550 y(modules)c(are)j(used)e(through)g(the)h(same)f(simple)g(API)h
(functions)f(described)h(in)f(the)h(subsections)e(belo)n(w)-6
b(.)-57 4929 y Fb(3.3.1)118 b(Loading)30 b(and)h(deallocating)g
(modules)109 5199 y Fg(Loading)23 b(modules)f(with)h(MID)l(AS)h
(Digital)f(Audio)g(System)h(is)f(v)o(ery)g(simple,)g(just)g(call)h
Fa(MID)m(ASloadMod-)109 5320 y(ule)p Fg(,)31 b(gi)n(ving)d(as)i(an)g
(ar)n(gument)g(the)g(name)g(of)g(the)g(module)f(\002le.)46
b Fa(MID)m(ASloadModule)28 b Fg(returns)i(a)g(module)109
5440 y(handle)24 b(of)g(type)g Fa(MID)m(ASmodule)p Fg(,)f(which)h(can)g
(then)g(be)h(used)f(to)g(refer)h(to)f(the)g(module.)30
b(After)24 b(the)g(module)109 5560 y(is)g(no)h(longer)f(used,)g(it)h
(should)e(be)i(deallocated)g(with)f Fa(MID)m(ASfr)l(eeModule)p
Fg(.)p eop
%%Page: 11 15
11 14 bop 109 208 a Ff(CHAPTER)25 b(3.)56 b(USING)25
b(MID)l(AS)g(DIGIT)-9 b(AL)25 b(A)-5 b(UDIO)24 b(SYSTEM)1247
b Fg(11)-57 473 y Fb(3.3.2)118 b(Playing)30 b(modules)109
743 y Fg(Modules)24 b(that)h(ha)n(v)o(e)h(been)f(loaded)h(into)e
(memory)h(can)h(be)g(played)f(by)h(calling)e Fa(MID)m(ASplayModule)p
Fg(.)32 b Fa(MI-)109 863 y(D)m(ASplayModule)19 b Fg(tak)o(es)i(as)g(an)
g(ar)n(gument)g(the)g(module)f(handle)h(for)g(the)g(module,)g(and)g(a)g
(boolean)g(\003ag)h(that)109 983 y(indicates)j(whether)g(or)h(not)f
(the)h(module)f(playback)g(should)g(loop)g(or)h(not.)33
b(It)25 b(returns)h(a)g(module)f(playback)109 1104 y(handle)i(of)g
(type)g Fa(MID)m(ASmodulePlayHandle)e Fg(that)i(can)h(be)g(used)f(to)g
(refer)i(to)e(the)g(module)f(as)i(it)f(is)g(being)109
1224 y(played.)109 1426 y Fa(MID)m(ASplayModuleSection)g
Fg(can)k(be)f(used)f(to)h(play)g(just)f(a)h(portion)f(of)h(the)g
(module.)45 b(A)30 b(single)f(module)109 1547 y(could,)23
b(for)i(e)o(xample,)f(contain)f(se)n(v)o(eral)h(dif)n(ferent)g(songs,)f
(and)h Fa(MID)m(ASplayModuleSection)e Fg(can)j(be)g(used)109
1667 y(to)f(select)h(which)f(one)h(of)g(them)f(to)g(play)-6
b(.)109 1870 y(MID)l(AS)32 b(is)f(also)h(capable)g(of)g(playing)f(se)n
(v)o(eral)h(modules)f(simultaneously)-6 b(,)30 b(or)i(e)n(v)o(en)g(the)
f(same)h(module)109 1990 y(se)n(v)o(eral)e(times)g(from)h(dif)n(ferent)
g(positions.)48 b(There)32 b(are)g(some)e(limitations,)g(ho)n(we)n(v)o
(er)l(,)i(see)f Fa(MID)m(ASplay-)109 2110 y(Module)f
Fg(documentation)e(for)j(details.)47 b(This)30 b(can)h(be)f(useful)g
(for)h(using)e(module)h(sections)f(as)i(sound)f(ef-)109
2231 y(fects,)25 b(or)f(f)o(ading)h(between)g(tw)o(o)f(modules.)109
2433 y(Module)k(playback)g(can)i(be)f(stopped)f(by)g(calling)h
Fa(MID)m(ASstopModule)p Fg(,)e(passing)h(it)h(as)g(an)g(ar)n(gument)f
(the)109 2554 y(module)23 b(playback)i(handle)g(returned)f(by)h
Fa(MID)m(ASplayModule)p Fg(.)-57 2930 y Fb(3.3.3)118
b(Contr)n(olling)31 b(module)g(playback)109 3199 y Fg(Although)24
b(typically)h(module)g(playback)h(just)f(proceeds)h(without)f(user)h
(interv)o(ention,)e(it)h(is)h(also)g(possible)109 3320
y(to)33 b(control)h(the)f(playback)h(of)g(the)g(module.)57
b Fa(MID)m(ASsetP)-8 b(osition)31 b Fg(can)k(be)f(used)f(to)h(change)g
(the)g(current)109 3440 y(playing)c(position,)h Fa(MID)m(ASsetMusicV)
-11 b(olume)29 b Fg(to)i(set)g(the)g(master)g(v)n(olume)f(of)i(the)f
(music,)h(and)f Fa(MID)m(AS-)109 3560 y(fadeMusicChannel)21
b Fg(to)i(f)o(ade)g(indi)n(vidual)d(music)i(channels)g(in)h(or)g(out.)
29 b(All)22 b(of)h(these)g(functions)e(require)i(as)109
3681 y(their)h(\002rst)h(ar)n(gument)g(the)f(module)g(playing)g(handle)
g(from)h Fa(MID)m(ASplayModule)p Fg(.)-57 4057 y Fb(3.3.4)118
b(Getting)30 b(module)h(inf)m(ormation)109 4326 y Fg(In)19
b(MID)l(AS)h(Digital)e(Audio)h(System,)h(it)f(is)g(possible)g(to)g
(query)g(information)g(about)g(a)h(module)e(or)i(the)f(status)109
4447 y(of)28 b(module)f(playback.)41 b(This)28 b(information)e(can)j
(be)f(used)g(to)g(update)g(an)h(user)f(interf)o(ace,)h(or)g
(synchronize)109 4567 y(the)24 b(program)h(operation)f(to)g(the)h
(music)f(playback.)109 4770 y(Basic)30 b(information)f(about)h(the)g
(module,)g(such)g(as)g(its)g(name,)h(is)f(a)n(v)n(ailable)f(by)h
(calling)f Fa(MID)m(ASg)o(etMod-)109 4890 y(uleInfo)p
Fg(.)g(The)22 b(function)f(requires)g(as)h(an)g(ar)n(gument)g(a)g
(module)f(handle)g(returned)h(by)f Fa(MID)m(ASloadModule)p
Fg(,)109 5010 y(and)k(a)h(pointer)e(to)h(a)h Fa(MID)m(ASmoduleInfo)e
Fg(structure,)h(which)g(it)g(then)g(will)f(\002ll)h(with)g(the)g
(module)g(informa-)109 5131 y(tion.)48 b(A)31 b(similar)f(function,)i
Fa(MID)m(ASg)o(etInstrumentInfo)p Fg(,)d(is)i(a)n(v)n(ailable)f(for)h
(reading)g(information)f(about)109 5251 y(indi)n(vidual)22
b(instruments)h(in)h(the)h(module.)109 5453 y(The)34
b(current)i(status)d(of)i(the)g(playback)g(of)f(a)i(module)d(can)j(be)f
(read)g(with)f Fa(MID)m(ASg)o(etPlayStatus)p Fg(.)58
b(It)35 b(is)109 5574 y(passed)20 b(a)i(module)d(playback)i(handle)g
(from)g Fa(MID)m(ASplayModule)p Fg(,)e(and)i(a)h(pointer)e(to)g(a)i
Fa(MID)m(ASplayStatus)109 5694 y Fg(structure,)42 b(which)d(it)f(will)g
(then)h(\002ll)g(with)f(the)h(playback)g(status)f(information.)72
b(The)39 b(playback)g(status)p eop
%%Page: 12 16
12 15 bop 109 208 a Ff(CHAPTER)25 b(3.)56 b(USING)25
b(MID)l(AS)g(DIGIT)-9 b(AL)25 b(A)-5 b(UDIO)24 b(SYSTEM)1247
b Fg(12)109 473 y(information)23 b(includes)g(the)i(current)g(module)e
(playback)h(position,)f(pattern)h(number)g(in)h(that)f(position)e(and)
109 593 y(the)i(current)h(playback)g(ro)n(w)-6 b(,)24
b(as)h(well)f(as)h(the)g(most)e(recent)j(music)d(synchronization)h
(command)g(infobyte.)109 791 y(MID)l(AS)i(Digital)g(Audio)g(System)g
(also)g(supports)f(a)i(music)f(synchronization)f(callback)i(function,)f
(which)109 912 y(will)33 b(be)h(called)g(each)h(time)e(the)h(player)g
(encounters)f(a)i(music)e(synchronization)f(command.)58
b(The)34 b(syn-)109 1032 y(chronization)27 b(command)h(is)g
Fh(Wxx)g Fg(for)g(Scream)i(T)m(rack)o(er)e(3)h(and)f(F)o(astT)m(rack)o
(er)h(2)f(modules,)g(and)g Fh(Zxx)h Fg(for)109 1153 y(Impulse)24
b(T)m(rack)o(er)h(modules.)k(The)c(callback)g(can)g(be)g(set)f(or)h
(remo)o(v)o(ed)f(with)g(the)g(function)g Fa(MID)m(ASsetMu-)109
1273 y(sicSyncCallbac)n(k)p Fg(.)37 b(As)27 b(the)g(music)g
(synchronization)e(callback)j(is)e(called)i(in)f(MID)l(AS)g(player)g
(conte)o(xt,)g(it)109 1393 y(should)c(be)i(k)o(ept)g(as)g(short)f(and)h
(simple)e(as)i(possible,)e(and)i(it)f(may)h(not)f(call)h(MID)l(AS)g
(functions.)-57 1805 y Fe(3.4)142 b(Using)35 b(samples)109
2106 y Fg(Using)i(samples)f(is)i(the)f(easiest)h(w)o(ay)g(to)f(add)h
(sound)e(ef)n(fects)i(and)g(other)g(miscellaneous)e(sounds)h(to)g(a)109
2227 y(program)29 b(with)g(MID)l(AS)g(Digital)g(Audio)g(System.)44
b(This)29 b(section)g(describes)h(ho)n(w)e(samples)h(are)h(used)g(in)
109 2347 y(MID)l(AS.)-57 2714 y Fb(3.4.1)118 b(Loading)30
b(samples)109 2980 y Fg(Before)35 b(samples)d(can)i(be)g(used,)i(the)o
(y)d(naturally)f(need)i(to)g(be)f(loaded)h(into)f(memory)-6
b(.)56 b(MID)l(AS)33 b(Digital)109 3100 y(Audio)22 b(System)h
(currently)f(supports)g(samples)g(in)h(tw)o(o)g(formats:)29
b(ra)o(w)23 b(audio)g(data)g(\002les)g(and)g(RIFF)i(W)-12
b(A)f(VE)109 3221 y(\002les.)44 b(Ra)o(w)29 b(sample)g(\002les)g(can)h
(be)f(loaded)g(with)f Fa(MID)m(ASloadRawSample)p Fg(,)h(and)g(RIFF)i(W)
-12 b(A)f(VE)28 b(samples)109 3341 y(with)22 b Fa(MID)m(ASloadW)-9
b(aveSample)p Fg(.)27 b(Both)c(functions)e(require)i(as)g(ar)n(guments)
f(the)g(name)h(of)g(the)f(sample)g(\002le,)109 3461 y(and)27
b(sample)g(looping)f(\003ag)h(\227)h(1)f(if)g(the)g(sample)g(should)f
(be)i(looped,)f(0)g(if)h(not.)37 b Fa(MID)m(ASloadRawSample)109
3582 y Fg(also)29 b(requires)h(the)g(sample)f(type)g(as)h(an)g(ar)n
(gument,)h Fa(MID)m(ASloadW)-9 b(aveSample)27 b Fg(determines)j(it)f
(from)g(the)109 3702 y(\002le)j(header)-5 b(.)52 b(Both)31
b(functions)g(return)h(a)g(sample)f(handle)h(of)g(type)f
Fa(MID)m(ASsample)g Fg(that)g(can)h(be)g(used)g(to)109
3823 y(refer)26 b(to)e(the)h(sample.)109 4021 y(After)i(the)f(samples)g
(are)h(no)f(longer)h(used,)f(the)o(y)g(should)g(be)g(deallocated)h
(with)f Fa(MID)m(ASfr)l(eeSample)p Fg(.)35 b(Y)-11 b(ou)109
4141 y(need)31 b(to)f(mak)o(e)h(sure,)i(ho)n(we)n(v)o(er)l(,)e(that)f
(the)h(sample)f(is)h(no)g(longer)f(being)h(played)f(on)h(an)o(y)f
(sound)g(channel)109 4261 y(when)24 b(it)h(is)f(deallocated.)-57
4629 y Fb(3.4.2)118 b(Playing)30 b(samples)109 4894 y
Fg(Samples)19 b(that)g(ha)n(v)o(e)g(been)g(loaded)g(into)g(memory)f
(can)i(be)g(played)f(with)f(the)i(function)e Fa(MID)m(ASplaySample)p
Fg(.)109 5015 y(It)j(tak)o(es)g(as)h(ar)n(guments)f(the)g(sample)g
(handle,)g(playback)g(channel)h(number)l(,)f(and)h(initial)e(v)n(alues)
g(for)i(sample)109 5135 y(priority)-6 b(,)29 b(playback)g(rate,)i(v)n
(olume)e(and)h(panning.)44 b(The)30 b(function)e(returns)i(a)g(MID)l
(AS)g(sample)f(playback)109 5255 y(handle)g(of)g(type)g
Fa(MID)m(ASsamplePlayHandle)d Fg(that)j(can)h(be)f(used)g(to)g(refer)h
(to)f(the)g(sample)f(as)h(it)g(is)g(being)109 5376 y(played.)h(A)25
b(single)f(sample)g(can)h(be)g(played)g(an)o(y)f(number)g(of)h(times)f
(simultaneously)-6 b(.)109 5574 y(Sample)30 b(playback)g(can)g(be)h
(stopped)e(with)h Fa(MID)m(ASstopSample)p Fg(,)f(b)n(ut)g(this)h(is)f
(not)h(necessary)h(before)f(the)109 5694 y(sample)d(will)g(be)h
(deallocated)f(\227)h(a)g(ne)n(w)g(sample)f(can)h(simply)e(be)i(played)
g(on)f(the)h(same)g(channel,)g(and)g(it)p eop
%%Page: 13 17
13 16 bop 109 208 a Ff(CHAPTER)25 b(3.)56 b(USING)25
b(MID)l(AS)g(DIGIT)-9 b(AL)25 b(A)-5 b(UDIO)24 b(SYSTEM)1247
b Fg(13)109 473 y(will)27 b(then)g(replace)i(the)e(pre)n(vious)g(one.)
39 b(The)28 b(sample)f(handles)h(will)f(be)g(rec)o(ycled)h(as)g
(necessary)-6 b(,)29 b(so)e(there)109 593 y(is)d(no)h(danger)g(of)f
(memory)g(leaks.)-57 971 y Fb(3.4.3)118 b(Samples)30
b(and)h(channels)109 1242 y Fg(One)g(sound)f(channel)h(can)h(be)f(used)
g(to)f(play)h(a)g(single)g(sample,)g(and)h(therefore)f
Fa(MID)m(ASplaySample)f Fg(re-)109 1362 y(quires)e(the)g(number)h(of)f
(the)h(channel)f(that)h(is)f(used)g(to)g(play)h(the)f(sample)g(as)h(an)
g(ar)n(gument.)42 b(The)28 b(channel)109 1483 y(number)23
b(can)h(be)g(set)f(manually)-6 b(,)23 b(or)h(MID)l(AS)f(Digital)g
(Audio)g(System)g(can)h(handle)g(the)f(channel)h(selection)109
1603 y(automatically)-6 b(.)109 1807 y(If)37 b(the)g(channel)f(number)h
(for)g(the)g(sample)f(is)g(set)h(manually)-6 b(,)38 b(the)f(channel)f
(used)h(should)f(be)h(allocated)109 1927 y(with)32 b
Fa(MID)m(ASallocateChannel)f Fg(to)i(ensure)g(that)g(the)g(channel)g
(is)g(not)f(being)h(used)g(for)g(other)g(purposes.)109
2047 y(If)i(a)g(free)h(channel)f(is)g(a)n(v)n(ailable,)i(the)e
(function)f(will)g(return)h(its)f(number)h(that)f(can)h(then)g(be)g
(used)g(with)109 2168 y Fa(MID)m(ASplaySample)p Fg(.)e(After)26
b(the)g(channel)g(is)g(no)g(longer)f(used,)i(it)e(should)g(be)h
(deallocated)g(with)g Fa(MID)m(AS-)109 2288 y(fr)l(eeChannel)p
Fg(.)109 2492 y(Another)21 b(possibility)e(is)i(to)g(let)g(MID)l(AS)h
(select)g(the)f(channel)h(automatically)-6 b(.)27 b(A)22
b(number)f(of)h(channels)f(can)109 2612 y(be)f(allocated)f(for)i(use)f
(as)g(automatic)f(ef)n(fect)h(channels)g(with)f Fa(MID)m(ASallocA)n
(utoEf)n(fectChannels)p Fg(.)26 b Fa(MID)m(AS-)109 2732
y(playSample)21 b Fg(can)i(then)f(be)h(passed)f Fh(MID)m(AS)p
1691 2732 30 4 v 35 w(CHANNEL)p 2224 2732 V 36 w(A)-5
b(UT)n(O)23 b Fg(as)g(the)f(channel)g(number)l(,)h(and)f(it)g(will)109
2853 y(automatically)k(select)h(the)h(channel)g(that)f(will)g(be)g
(used)h(to)f(play)g(the)h(ef)n(fect.)40 b(After)28 b(the)f(automatic)g
(ef)n(fect)109 2973 y(channels)d(are)i(no)e(longer)h(used,)f(the)o(y)g
(should)g(be)h(deallocated)f(with)g Fa(MID)m(ASfr)l(eeA)n(utoEf)n
(fectChannels)p Fg(.)-57 3351 y Fb(3.4.4)118 b(Contr)n(olling)31
b(sample)f(playback)109 3622 y Fg(Most)25 b(sample)g(playback)h
(properties)f(can)i(be)f(changed)g(while)f(it)h(is)f(being)h(played.)34
b Fa(MID)m(ASsetSampleR-)109 3742 y(ate)f Fg(can)h(be)g(used)f(to)g
(change)h(its)e(playback)i(rate,)i Fa(MID)m(ASsetSampleV)-11
b(olume)31 b Fg(its)h(v)n(olume,)j Fa(MID)m(ASset-)109
3863 y(SampleP)-8 b(anning)25 b Fg(its)h(panning)g(position)f(and)i
Fa(MID)m(ASsetSamplePriority)d Fg(its)i(playback)g(priority)-6
b(.)36 b(All)26 b(of)109 3983 y(these)h(functions)g(tak)o(e)h(as)g(an)g
(ar)n(gument)f(the)h(sample)f(playback)h(handle)f(from)h
Fa(MID)m(ASplaySample)p Fg(,)e(and)109 4103 y(the)e(ne)n(w)h(v)n(alue)f
(for)h(the)g(playback)f(property)-6 b(.)109 4307 y(The)22
b(sample)f(playback)h(properties)g(can)g(be)h(changed)f(at)g(an)o(y)g
(point)f(after)i(the)f(sample)f(playback)h(has)g(been)109
4427 y(started)i(until)e(the)i(sample)g(playback)g(is)g(stopped)f(with)
g Fa(MID)m(ASstopSample)p Fg(.)28 b(If)d(the)f(sample)f(has)h(reached)
109 4548 y(its)i(end,)i(or)f(has)g(been)g(replaced)h(by)e(another)h
(sample)g(with)f(automatic)g(channel)h(selection,)g(the)g(function)109
4668 y(call)d(is)h(simply)e(ignored.)-57 5046 y Fb(3.4.5)118
b(Getting)30 b(sample)g(inf)m(ormation)109 5317 y Fg(The)36
b(sample)g(playback)g(status)f(can)h(be)h(monitored)e(with)g
Fa(MID)m(ASg)o(etSamplePlayStatus)p Fg(.)62 b(It)36 b(tak)o(es)g(as)109
5437 y(an)28 b(ar)n(gument)g(the)g(sample)g(playback)g(handle,)h(and)f
(returns)g(the)h(current)f(sample)g(playback)g(status.)40
b(The)109 5558 y(playback)e(status)h(information)e(can)j(be)f(used)f
(to)h(determine)g(whether)g(or)g(not)f(a)i(sample)e(has)h(already)109
5678 y(reached)25 b(its)f(end.)p eop
%%Page: 14 18
14 17 bop 109 208 a Ff(CHAPTER)25 b(3.)56 b(USING)25
b(MID)l(AS)g(DIGIT)-9 b(AL)25 b(A)-5 b(UDIO)24 b(SYSTEM)1247
b Fg(14)-57 473 y Fe(3.5)142 b(Using)35 b(str)m(eams)109
779 y Fg(In)21 b(MID)l(AS)g(Digital)f(Audio)h(System,)g(streams)g(are)h
(continuous)e(\003o)n(ws)g(of)i(sample)e(data.)30 b(Unlik)o(e)20
b(samples,)109 900 y(the)o(y)h(do)h(not)g(need)h(to)f(be)h(loaded)f
(completely)f(into)h(memory)f(before)i(the)o(y)f(can)h(be)g(played,)f
(b)n(ut)g(can)h(rather)109 1020 y(be)k(loaded)f(from)h(disk)f(or)h
(generated)h(as)f(necessary)-6 b(.)37 b(This)26 b(section)g(describes)h
(ho)n(w)f(streams)g(are)i(used)f(in)109 1141 y(MID)l(AS.)-57
1563 y Fe(3.6)142 b(Playing)35 b(str)m(eams)109 1870
y Fg(There)29 b(are)g(tw)o(o)f(dif)n(ferent)h(w)o(ays)f(of)h(playing)e
(streams)i(in)f(MID)l(AS)h(Digital)e(Audio)h(System:)38
b(stream)28 b(\002le)109 1990 y(playback)j(and)g(polling)g(stream)g
(playback.)50 b(In)32 b(stream)f(\002le)h(playback,)h(MID)l(AS)f
(creates)g(a)g(ne)n(w)f(thread)109 2110 y(that)f(will)h(read)g(the)g
(stream)g(data)g(from)g(a)g(gi)n(v)o(en)f(\002le)h(and)h(plays)e(it)h
(automatically)e(on)i(the)g(background.)109 2231 y(In)j(polling)e
(stream)h(playback)h(the)f(user)h(needs)g(to)g(read)g(or)g(generate)g
(the)g(stream)f(data,)j(and)e(feed)g(it)g(to)109 2351
y(MID)l(AS.)109 2555 y(Stream)43 b(\002les)h(are)g(played)f(with)f
Fa(MID)m(ASplayStr)l(eamF)l(ile)f Fg(and)i Fa(MID)m(ASplayStr)l(eamW)-9
b(aveF)l(ile)p Fg(.)83 b(Both)109 2675 y(functions)26
b(require)h(as)g(ar)n(guments)f(the)h(stream)g(\002le)g(name,)g(stream)
g(playback)g(b)n(uf)n(fer)g(length)f(and)h(stream)109
2795 y(looping)21 b(\003ag.)30 b(The)23 b(\002les)f(played)g(with)g
Fa(MID)m(ASplayStr)l(eamF)l(ile)e Fg(should)h(contain)h(only)g(ra)o(w)g
(sample)g(data,)109 2916 y(and)i(the)h(function)f(will)g(therefore)h
(require)g(as)g(ar)n(guments)f(also)g(the)h(stream)f(data)h(sample)f
(type)h(and)f(play-)109 3036 y(back)32 b(rate.)52 b Fa(MID)m(ASplayStr)
l(eamW)-9 b(aveF)l(ile)29 b Fg(plays)i(RIFF)j(W)-12 b(A)f(VE)31
b(\002les,)j(and)e(can)g(read)g(the)g(information)109
3157 y(from)h(the)g(\002le)g(header)-5 b(.)57 b(The)33
b(playback)g(functions)f(will)g(return)i(a)f(stream)g(handle)g(that)g
(can)g(be)h(used)f(to)109 3277 y(refer)26 b(to)e(the)h(stream.)109
3480 y(Polling)i(stream)i(playback)f(is)g(started)g(with)g
Fa(MID)m(ASplayStr)l(eamP)-8 b(olling)p Fg(.)39 b(It)29
b(requires)f(as)h(its)f(ar)n(guments)109 3601 y(the)i(stream)g(sample)g
(type,)i(playback)e(rate)h(and)f(b)n(uf)n(fer)h(length.)47
b(The)30 b(actual)h(stream)f(playback)g(will)g(not)109
3721 y(start,)e(ho)n(we)n(v)o(er)l(,)f(until)g(some)h(stream)g(data)g
(is)f(fed)i(to)e(the)h(system)f(with)g Fa(MID)m(ASfeedStr)l(eamData)p
Fg(.)39 b(After)109 3841 y(the)g(playback)f(has)h(starter)l(,)k
Fa(MID)m(ASfeedStr)l(eamData)37 b Fg(needs)i(to)g(be)g(called)g
(periodically)f(to)h(feed)g(the)109 3962 y(system)e(ne)n(w)g(stream)h
(data)g(to)g(play)-6 b(,)41 b(otherwise)c(the)h(system)f(will)g(run)h
(out)g(of)g(stream)g(data)g(and)g(stop)109 4082 y(playback.)109
4286 y(The)24 b(stream)f(playback)h(b)n(uf)n(fer)g(length)f(controls)g
(the)g(amount)g(of)h(stream)g(data)g(b)n(uf)n(fered)g(for)g(stream)f
(play-)109 4406 y(back.)36 b(The)27 b(longer)g(the)f(b)n(uf)n(fer)h
(is,)g(the)f(longer)h(the)f(system)g(can)h(play)g(the)f(stream)h(when)f
(ne)n(w)h(data)g(is)f(not)109 4526 y(a)n(v)n(ailable)f(until)h(the)g
(playback)g(needs)g(to)g(be)h(stopped.)34 b(Running)26
b(out)g(of)g(stream)g(data)h(will)e(result)h(in)g(irri-)109
4647 y(tating)h(breaks)h(in)g(the)g(sound)f(and)h(should)f(be)h(a)n(v)n
(oided.)40 b(Longer)28 b(playback)g(b)n(uf)n(fers)g(will,)g(ho)n(we)n
(v)o(er)l(,)f(add)109 4767 y(delay)i(to)h(the)f(stream)h(playback,)h
(and)e(consume)g(more)h(memory)-6 b(.)44 b(F)o(or)30
b(stream)g(\002le)g(playback,)g(a)h(stream)109 4888 y(b)n(uf)n(fer)21
b(length)f(of)h(500ms)e(should)h(be)h(suitable.)29 b(F)o(or)20
b(polling)g(stream)g(playback,)i(the)f(b)n(uf)n(fer)f(length)g(should)
109 5008 y(be)25 b(at)f(least)h(twice)g(the)f(longest)g(e)o(xpected)h
(delay)f(between)h(tw)o(o)f(calls)h(to)f Fa(MID)m(ASfeedStr)l(eamData)p
Fg(.)109 5211 y(Stream)h(playback)f(is)h(stopped)f(with)g
Fa(MID)m(ASstopStr)l(eam)p Fg(,)e(re)o(gardless)i(of)h(the)g(stream)f
(type.)p eop
%%Page: 15 19
15 18 bop 109 208 a Ff(CHAPTER)25 b(3.)56 b(USING)25
b(MID)l(AS)g(DIGIT)-9 b(AL)25 b(A)-5 b(UDIO)24 b(SYSTEM)1247
b Fg(15)-57 473 y Fb(3.6.1)118 b(Contr)n(olling)31 b(str)n(eam)e
(playback)109 744 y Fg(The)c(stream)g(playback)h(properties)f(can)g(be)
h(changed)g(while)f(it)g(is)g(being)g(played.)32 b Fa(MID)m(ASsetStr)l
(eamRate)109 864 y Fg(can)j(be)g(used)g(to)g(change)g(its)g(playback)f
(rate,)39 b Fa(MID)m(ASsetStr)l(eamV)-11 b(olume)33 b
Fg(its)h(v)n(olume)g(and)h Fa(MID)m(ASset-)109 984 y(Str)l(eamP)-8
b(anning)35 b Fg(its)i(panning)g(position.)67 b(All)37
b(of)g(these)h(functions)e(tak)o(e)i(as)f(an)h(ar)n(gument)f(the)h
(stream)109 1105 y(handle)24 b(from)h(the)f(stream)h(playback)f
(function,)g(and)h(the)g(ne)n(w)f(v)n(alue)g(for)h(the)g(playback)g
(property)-6 b(.)109 1308 y(The)34 b(playback)h(of)f(the)h(stream)f
(can)h(also)f(be)h(paused)f(with)g Fa(MID)m(ASpauseStr)l(eam)p
Fg(,)h(and)f(resumed)h(after)109 1428 y(pausing)23 b(with)g
Fa(MID)m(ASr)l(esumeStr)l(eam)p Fg(.)29 b(This)23 b(can)h(be)g(useful)g
(if)g(your)f(application)g(kno)n(ws)g(it)g(will)g(run)h(out)109
1549 y(of)h(stream)f(data)h(soon,)f(and)h(wishes)f(to)g(f)o(ade)i(the)e
(stream)h(out)f(and)h(pause)f(it)h(until)e(more)i(data)g(is)f(a)n(v)n
(ailable.)109 1669 y(Stream)f(data)g(reading)g(and)g(feeding)g(can)h
(continue)e(while)h(the)f(stream)h(is)g(paused)g(until)f(the)h(stream)f
(b)n(uf)n(fer)109 1790 y(is)i(full.)-57 2168 y Fb(3.6.2)118
b(Getting)30 b(str)n(eam)f(inf)m(ormation)109 2438 y
Fg(The)19 b(amount)f(of)h(data)h(currently)f(in)f(the)h(stream)g(b)n
(uf)n(fer)g(can)h(be)f(monitored)f(with)h Fa(MID)m(ASg)o(etStr)l
(eamBytes-)109 2559 y(Buf)n(fer)l(ed)p Fg(.)41 b(The)28
b(information)f(could)h(be)g(used)g(to)g(determine)g(ho)n(w)f(soon)h
(ne)n(w)g(stream)g(data)g(is)g(needed)h(to)109 2679 y(continue)h
(playback,)i(or)f(whether)g(or)g(not)g(enough)f(space)i(e)o(xists)d(in)
i(the)g(stream)f(b)n(uf)n(fer)h(for)h(a)f(complete)109
2800 y(ne)n(w)24 b(block)g(of)h(data.)109 3003 y(Note)33
b(that)h(with)f(ADPCM)h(streams)g(the)f(stream)h(b)n(uf)n(fer)g
(contains)f(the)h(decompressed)f(data,)j(as)e(16-bit)109
3123 y(samples,)23 b(instead)i(of)g(the)f(compressed)g(ADPCM)i(data.)
-57 3546 y Fe(3.7)142 b(Using)35 b(echo)g(effects)109
3852 y Fg(The)27 b(MID)l(AS)h(Digital)e(Audio)h(System)f(Echo)i(Ef)n
(fects)f(Engine)g(can)g(be)h(used)f(to)g(add)h(dif)n(ferent)f(echo)g
(and)109 3973 y(re)n(v)o(erb)33 b(ef)n(fects)h(to)f(the)h(sound)f
(output.)57 b(These)33 b(ef)n(fects)h(can)g(range)h(from)e(simple)g
(echoes)h(and)g(\002ltering)109 4093 y(ef)n(fects)h(to)g(hea)n(vy)g
(hall)f(re)n(v)o(erbs)h(and)g(stereo)g(enhancements.)61
b(This)34 b(section)h(describes)g(ho)n(w)f(the)h(echo)109
4214 y(ef)n(fects)25 b(are)g(used)-57 4592 y Fb(3.7.1)118
b(Adding)32 b(echo)e(effects)109 4862 y Fg(Echo)25 b(ef)n(fects)g(are)h
(added)g(to)f(the)g(sound)f(output)h(with)f Fa(MID)m(ASaddEc)o(hoEf)n
(fect)p Fg(.)30 b(It)c(tak)o(es)f(as)g(an)h(ar)n(gument)109
4983 y(a)21 b(pointer)f(to)g(a)h(\002lled)g Fa(MID)m(ASec)o(hoSet)e
Fg(structure)i(\(described)g(belo)n(w\),)f(and)h(returns)g(and)f(echo)h
(handle)g(that)109 5103 y(can)f(then)f(be)h(used)g(to)f(refer)i(to)f
(the)f(ef)n(fect.)30 b(The)20 b(echo)g(set)f(structure)h(is)f(not)g
(used)h(after)g Fa(MID)m(ASaddEc)o(hoEf-)109 5224 y(fect)k
Fg(returns,)g(and)h(may)f(be)g(deallocated.)31 b(An)o(y)23
b(number)h(of)h(echo)f(ef)n(fects)h(can)f(be)h(acti)n(v)o(e)e
(simultaneously)-6 b(.)109 5427 y(After)37 b(the)f(echo)i(ef)n(fect)f
(is)f(no)h(longer)f(w)o(anted,)k(it)c(can)h(be)g(remo)o(v)o(ed)f(from)g
(the)h(output)f(with)g Fa(MID)m(AS-)109 5547 y(r)l(emo)o(veEc)o(hoEf)n
(fect)p Fg(.)49 b(Note)31 b(that)g(modifying)e(the)i
Fa(MID)m(ASec)o(hoSet)f Fg(structure)h(of)h(an)f(echo)g(ef)n(fect)h
(that)f(is)109 5668 y(already)25 b(being)f(used)h(has)f(no)h(ef)n
(fect.)p eop
%%Page: 16 20
16 19 bop 109 208 a Ff(CHAPTER)25 b(3.)56 b(USING)25
b(MID)l(AS)g(DIGIT)-9 b(AL)25 b(A)-5 b(UDIO)24 b(SYSTEM)1247
b Fg(16)-57 473 y Fb(3.7.2)118 b(The)30 b(echo)h(effect)e(structur)n(e)
109 744 y Fg(A)j(MID)l(AS)f(Digital)g(Audio)g(System)g(echo)h(ef)n
(fect)h(is)e(described)h(by)f(a)h Fa(MID)m(ASec)o(hoSet)f
Fg(structure.)51 b(The)109 864 y(echo)31 b(set)g(contains)f(three)i
(common)e(\002elds)h(plus)f(one)h(or)h(more)f(echoes.)49
b(The)32 b Fh(feedback)h Fg(\002eld)e(controls)109 984
y(the)24 b(amount)g(of)g(feedback)i(in)e(the)g(echo)h(set,)g
Fh(gain)f Fg(the)h(echo)f(ef)n(fect)h(total)f(gain,)g(and)h
Fh(numEchoes)h Fg(simply)109 1105 y(the)g(number)f(of)h(echoes)g(in)g
(the)g(echo)g(set.)35 b(See)27 b(the)e Fa(MID)m(ASec)o(hoSet)g
Fg(description)g(in)h(the)g(API)g(Reference)109 1225
y(for)f(more)f(details.)109 1428 y(The)29 b(echoes)g(of)g(an)g(echo)g
(set)g(are)g(described)g(by)g(an)g(array)h(of)f Fa(MID)m(ASec)o(ho)f
Fg(structures.)42 b(Each)29 b(echo)g(has)109 1549 y(\002elds)j(that)h
(describe)f(its)g(delay)-6 b(,)34 b(gain,)g(\002ltering)e(and)h
(channel)f(re)n(v)o(erse)h(status.)53 b(The)33 b(delay)f(of)h(an)g
(echo)109 1669 y(controls)k(ho)n(w)g(f)o(ar)h(back)g(from)g(the)f(echo)
h(ef)n(fect)g(delay)g(line)g(the)f(data)h(for)g(the)g(echo)g(is)f(tak)o
(en)h(\227)f(the)109 1790 y(greater)25 b(the)g(delay)-6
b(,)24 b(the)g(longer)g(the)h(echo)g(is.)30 b(Gain)24
b(controls)g(the)h(strength)e(of)i(the)g(echo,)g(the)f(echo)h(data)g
(is)109 1910 y(essentially)20 b(multiplied)f(by)h(the)h(gain.)29
b(Each)22 b(echo)f(can)g(optionally)f(be)h(lo)n(w-pass)f(or)h
(high-pass)g(\002ltered,)h(in)109 2030 y(a)j(system)e(with)h(more)g
(than)g(a)h(couple)g(of)f(echoes,)h(lo)n(w-pass)e(\002ltering)h(can)h
(reduce)h(the)e(b)n(uild-up)f(of)i(high-)109 2151 y(frequenc)o(y)i
(noise.)39 b(Finally)-6 b(,)27 b(the)h(left)f(and)h(right)f(channels)g
(of)h(the)g(echo)g(can)g(be)g(re)n(v)o(ersed,)f(producing)g(an)109
2271 y(interesting)c(stereo)i(ef)n(fect)g(in)g(some)f(cases.)p
eop
%%Page: 17 21
17 20 bop 109 1220 a Fi(Chapter)51 b(4)109 1718 y(Adv)n(anced)g(topics)
109 2254 y Fg(This)20 b(chapter)h(includes)e(adv)n(anced)i(programming)
e(information)g(about)i(MID)l(AS)f(Digital)g(Audio)g(System.)109
2374 y(Although)e(the)h(information)f(contained)h(here)h(is)f(not)g
(necessary)h(for)g(being)f(able)g(to)h(use)f(MID)l(AS,)g(it)g(should)
109 2494 y(be)38 b(read)g(by)g(e)n(v)o(erybody)e(who)i(wishes)f(to)h
(get)g(e)n(v)o(erything)e(out)h(of)h(it.)70 b(T)-8 b(opics)37
b(co)o(v)o(ered)g(here)i(include)109 2615 y(performance)33
b(optimization,)f(sound)g(quality)g(optimization,)g(and)h(w)o(orking)f
(with)g(compressed)g(sample)109 2735 y(types.)-57 3158
y Fe(4.1)142 b(Optimizing)34 b(MID)-5 b(AS)35 b(perf)l(ormance)109
3464 y Fg(Although)f(MID)l(AS)j(Digital)e(Audio)g(System)g(has)i(been)f
(carefully)g(optimized)f(for)h(maximum)f(perfor)n(-)109
3585 y(mance,)23 b(playing)f(multichannel)f(digital)h(audio)g(can)i
(still)d(be)j(f)o(airly)e(time-consuming.)28 b(T)-8 b(o)23
b(get)g(around)f(the)109 3705 y(limitations)c(of)j(current)h(PC)g
(sound)e(cards,)i(MID)l(AS)f(needs)h(to)e(mix)h(the)g(sound)f(channels)
h(in)f(softw)o(are,)i(and)109 3826 y(this)e(mixing)f(process)i
(accounts)f(for)i(most)d(of)i(CPU)h(usage)f(caused)g(by)g(MID)l(AS.)g
(In)g(man)o(y)e(cases)j(tradeof)n(fs)109 3946 y(can)27
b(be)h(made)f(between)g(sound)g(quality)f(and)h(CPU)i(usage,)e
(although)g(it)f(is)h(also)g(possible)f(in)h(some)g(cases)109
4066 y(to)d(lo)n(wer)g(CPU)i(usage)f(dramatically)f(without)f(af)n
(fecting)i(sound)e(quality)-6 b(.)109 4270 y(In)34 b(some)g(cases)h
(the)f(opposite)f(is)h(also)g(true:)49 b(It)35 b(can)g(be)f(possible)f
(to)h(get)g(better)h(sound)e(quality)g(out)h(of)109 4390
y(MID)l(AS)28 b(without)f(using)g(much)h(additional)f(CPU)i(po)n(wer)-5
b(.)41 b(This)27 b(section)h(therefore)h(describes)f(ho)n(w)g(you)109
4510 y(can)h(get)g(best)f(possible)g(sound)g(quality)g(of)h(MID)l(AS)g
(while)f(using)g(as)h(little)f(CPU)i(time)e(as)h(possible,)f(and)109
4631 y(ho)n(w)c(to)g(\002nd)h(the)g(right)f(balance)h(between)g(sound)f
(quality)f(and)i(CPU)h(usage)f(for)g(your)f(application.)-57
5009 y Fb(4.1.1)118 b(The)30 b(number)h(of)f(channels)109
5280 y Fg(First)39 b(and)g(foremost,)j(the)d(CPU)h(time)e(used)h(for)h
(mixing)d(depends)i(on)g(the)g(number)g(of)g(acti)n(v)o(e)f(sound)109
5400 y(channels)27 b(in)h(use.)40 b(Each)28 b(channel)g(needs)g(to)g
(mix)o(ed)e(to)i(the)g(output)e(separately)-6 b(,)28
b(and)g(thus)f(requires)h(CPU)109 5520 y(time.)53 b(Note,)34
b(ho)n(we)n(v)o(er)l(,)e(that)g(the)h(total)e(number)h(of)h(open)f
(channels)g(is)g(not)g(v)o(ery)g(signi\002cant,)i(only)d(the)1949
5943 y(17)p eop
%%Page: 18 22
18 21 bop 109 208 a Ff(CHAPTER)25 b(4.)56 b(AD)l(V)-13
b(ANCED)24 b(T)n(OPICS)2165 b Fg(18)109 473 y(number)29
b(of)h(channels)f(that)g(are)i(actually)e(playing)g(sound.)44
b(Also,)30 b(sounds)f(played)g(at)h(zero)g(v)n(olume)f(tak)o(e)109
593 y(v)o(ery)24 b(little)g(CPU)h(time.)109 797 y(On)j(a)g(computer)g
(with)g(a)g(90MHz)g(Pentium)f(CPU,)i(with)f(the)g(def)o(ault)g(sound)g
(quality)f(settings,)g(the)h(CPU)109 917 y(time)36 b(used)h(is)g
(roughly)f(0.6\045\2260.9\045)h(of)g(the)g(total)g(CPU)h(time)e(per)i
(channel.)68 b(The)37 b(number)g(can)h(v)n(ary)109 1037
y(greatly)24 b(depending)h(on)f(the)h(type)g(of)g(samples)f(used)h(and)
f(other)h(f)o(actors,)g(b)n(ut)g(can)g(be)g(used)g(as)g(a)g(guideline)
109 1158 y(in)e(deciding)h(ho)n(w)f(man)o(y)g(sound)g(channels)h(to)g
(use.)30 b(Re)o(gardless)23 b(of)i(the)f(output)e(mode)i(settings,)f
(ho)n(we)n(v)o(er)l(,)109 1278 y(minimizing)f(the)j(number)f(of)h
(channels)f(used)h(is)f(an)h(easy)g(w)o(ay)g(to)f(increase)i(MID)l(AS)f
(performance.)109 1482 y(Using)32 b(fe)n(wer)h(sound)f(channels)h(does)
g(not)g(necessarily)f(mean)h(sacri\002cing)h(sound)e(quality)g(or)h
(richness.)109 1602 y(Music)g(modules)h(do)g(not)g(necessarily)h(need)f
(to)h(ha)n(v)o(e)f(o)o(v)o(er)g(10)g(channels)g(to)h(sound)e(good)h
(\227)h(talented)109 1722 y(musicians)24 b(ha)n(v)o(e)h(composed)g
(stunning)f(songs)h(with)g(the)g(Amiga)g(Protrack)o(er)h(program)g
(which)f(only)g(sup-)109 1843 y(ports)33 b(4)g(channels.)57
b(Unnecessary)34 b(or)g(v)o(ery)f(quiet)g(sound)g(ef)n(fects)g(could)g
(be)h(eliminated,)h(making)d(w)o(ay)109 1963 y(for)g(more)g(important)f
(ones.)52 b(Finally)-6 b(,)32 b(instead)g(of)g(playing)f(tw)o(o)h(or)g
(more)g(sounds)f(simultaneously)-6 b(,)30 b(the)109 2084
y(sounds)23 b(could)i(be)g(mix)o(ed)e(beforehand)i(with)f(a)h(sample)f
(editor)h(into)f(one.)-57 2462 y Fb(4.1.2)118 b(Sample)31
b(types)109 2732 y Fg(Another)d(f)o(actor)g(that)g(has)h(a)f(great)h
(ef)n(fect)g(on)f(MID)l(AS)g(Digital)g(Audio)f(System)h(CPU)h(usage)f
(is)g(the)h(type)109 2853 y(of)k(the)f(samples)g(played.)54
b(The)33 b(simplest)e(sample)i(type,)h(and)f(therefore)g(the)g(f)o
(astest)f(to)h(play)-6 b(,)34 b(is)e(a)h(8-bit)109 2973
y(mono)d(sample.)50 b(16-bit)30 b(samples)h(tak)o(e)g(typically)f
(50\045)i(more)f(CPU)h(time)f(to)g(play)g(than)g(8-bit)f(samples,)109
3093 y(and)i(stereo)h(samples)e(more)i(than)f(50\045)g(than)g
(corresponding)g(mono)f(samples.)53 b(In)33 b(addition,)g(ADPCM)109
3214 y(streams)c(tak)o(e)h(additional)f(CPU)i(time)e(for)h
(decompressing)f(the)h(ADPCM)g(data)g(to)g(16-bit)f(before)h(it)g(can)
109 3334 y(be)25 b(played.)109 3538 y(Ho)n(we)n(v)o(er)l(,)40
b(16-bit)e(samples)g(do)g(sound)g(much)g(better)h(than)f(8-bit)g(ones.)
72 b(A)39 b(good)f(compromise)f(is)i(to)109 3658 y(use)c
Fa(mu)p Fg(-la)o(w)g(samples)g(instead.)62 b Fa(mu)p
Fg(-la)o(w)35 b(samples)f(ha)n(v)o(e)i(almost)e(the)h(same)h(sound)e
(quality)h(as)g(16-bit)109 3778 y(samples,)41 b(while)d(being)h(as)g(f)
o(ast)f(to)h(mix)f(as)h(8-bit)f(samples.)72 b(In)39 b(addition,)i(the)o
(y)d(only)g(tak)o(e)h(as)g(much)109 3899 y(space)33 b(as)h(8-bit)f
(samples,)h(and)g(thus)e(lo)n(wer)h(the)g(memory)g(requirements)g(of)g
(the)g(program)g(as)h(well.)56 b(In)109 4019 y(some)33
b(mixing)f(modes)i(MID)l(AS)g(will)f(actually)g(automatically)g(con)l
(v)o(ert)g(16-bit)g(samples)g(to)h Fa(mu)p Fg(-la)o(w)f(if)109
4140 y(it)h(is)g(bene\002cial.)60 b(The)35 b(option)e
Fa(MID)m(AS)p 1553 4140 30 4 v 36 w(OPTION)p 1948 4140
V 36 w(16BIT)p 2233 4140 V 36 w(ULA)-9 b(W)p 2531 4140
V 36 w(A)k(UT)n(OCONVERT)36 b Fg(can)f(be)f(used)h(to)109
4260 y(control)24 b(this)g(beha)n(viour)-5 b(.)109 4463
y(ADPCM)29 b(compression)f(yields)g(a)h(1:4)g(compression)e(on)i
(16-bit)f(sound)g(data,)i(using)e(ef)n(fecti)n(v)o(ely)g(only)g(4)109
4584 y(bits)22 b(per)h(sample,)g(while)g(maintaining)e(sound)h(quality)
g(better)h(than)g(8-bit)f(samples.)30 b(As)22 b(ADPCM)i(sample)109
4704 y(data)35 b(cannot)g(easily)g(be)g(played)g(without)f
(decompressing)g(it)g(\002rst,)k(ho)n(we)n(v)o(er)l(,)f(MID)l(AS)e
(only)g(supports)109 4825 y(ADPCM)c(sample)g(data)g(in)g(streams.)49
b(Although)29 b(ADPCM)j(streams)e(tak)o(e)h(some)n(what)f(more)h(CPU)h
(time)109 4945 y(to)c(play)g(than)g(16-bit)g(streams,)g(as)h(the)f
(data)h(needs)f(to)g(be)h(decompressed,)g(the)o(y)e(can)i(still)e(turn)
h(out)g(to)g(be)109 5065 y(f)o(aster)d(in)f(practise,)h(as)g(the)f
(amount)g(of)h(data)g(that)f(needs)h(to)g(be)f(read)i(from)e(disk)g(is)
h(much)f(smaller)-5 b(.)p eop
%%Page: 19 23
19 22 bop 109 208 a Ff(CHAPTER)25 b(4.)56 b(AD)l(V)-13
b(ANCED)24 b(T)n(OPICS)2165 b Fg(19)-57 473 y Fb(4.1.3)118
b(Output)31 b(settings)109 744 y Fg(Finally)20 b(perhaps)g(the)h(most)e
(important)h(f)o(actor)h(in)f(determining)f(MID)l(AS)i(CPU)h(usage)e
(and)h(sound)f(quality:)109 864 y(output)i(sound)g(quality)g(settings.)
29 b(Se)n(v)o(eral)23 b(dif)n(ferent)g(sound)f(quality)g(settings)g
(can)i(be)f(adjusted,)f(and)i(each)109 984 y(can)h(be)g(used)f(to)h
(adjust)f(the)g(balance)h(of)g(sound)f(quality)g(and)h(CPU)g(usage.)109
1188 y(The)19 b(most)f(important)f(of)i(all)g(output)f(quality)g
(settings)f(is)i(the)f(mixing)g(mode.)28 b(By)19 b(def)o(ault,)h(MID)l
(AS)f(Digital)109 1308 y(Audio)38 b(System)g(uses)h(normal)f(mixing)f
(mode,)42 b(which)c(has)h(v)o(ery)f(good)h(performance.)73
b(High-quality)109 1428 y(mixing)23 b(mode)h(with)g(sound)g
(interpolation)g(is)g(a)n(v)n(ailable,)g(and)h(it)f(greatly)h(enhances)
g(the)g(sound)f(quality)g(in)109 1549 y(some)e(cases,)i(b)n(ut)e(also)h
(requires)g(much)f(more)h(CPU)h(po)n(wer)-5 b(.)29 b(High-quality)21
b(mixing)h(can)h(use)g(tw)o(o)f(to)h(three)109 1669 y(times)34
b(as)i(much)f(CPU)h(time)f(as)h(normal)f(quality)f(mixing,)j(and)e
(should)g(be)g(reserv)o(ed)h(for)g(applications)109 1790
y(that)26 b(only)h(use)g(a)h(fe)n(w)f(sound)f(channels)h(or)g(do)g(not)
g(require)h(the)f(CPU)h(time)e(for)i(other)f(uses.)38
b(The)27 b(mixing)109 1910 y(mode)36 b(settings)g(can)h(be)g(changed)h
(by)e(setting)g(the)h(option)f Fa(MID)m(AS)p 2577 1910
30 4 v 35 w(OPTION)p 2971 1910 V 37 w(MIXING)p 3356 1910
V 36 w(MODE)h Fg(with)109 2030 y Fa(MID)m(ASsetOption)p
Fg(.)109 2234 y(Another)f(setting)g(that)h(greatly)f(af)n(fects)i(CPU)f
(usage)g(and)g(sound)f(quality)g(is)h(the)g(output)e(mixing)h(rate.)109
2354 y(CPU)d(usage)g(depends)f(almost)g(linearly)g(on)g(the)h(mixing)e
(rate,)k(with)d(higher)h(mixing)e(rates)i(using)e(more)109
2475 y(CPU)c(po)n(wer)f(b)n(ut)g(also)g(sounding)f(better)-5
b(.)35 b(The)26 b(def)o(ault)h(mixing)e(rate)i(is)f(44100Hz,)g(b)n(ut)g
(in)g(man)o(y)f(cases)i(it)109 2595 y(can)f(be)f(lo)n(wered)g(to)g
(32000Hz)g(or)h(22050Hz)f(without)f(too)h(great)g(sound)g(quality)f
(loss.)32 b(In)26 b(addition,)e(if)i(all)109 2715 y(of)h(your)h(sounds)
e(are)i(played)g(at)f(the)h(same)f(rate)h(\(e)o(g.)39
b(22050Hz\),)28 b(the)f(mixing)f(rate)i(should)f(be)g(set)h(at)f(the)
109 2836 y(same)k(rate)i(\227)e(using)g(a)h(higher)g(rate)g(w)o(ould)f
(not)g(bring)h(an)o(y)f(better)h(sound)f(quality)g(and)g(could)h
(actually)109 2956 y(increase)25 b(noise)f(in)h(the)f(output.)109
3160 y(Experimenting)d(with)i(dif)n(ferent)g(mixing)f(rate)h(and)h
(mode)e(combinations)g(can)h(also)g(be)h(w)o(orthwhile,)e(as)i(in)109
3280 y(some)j(cases)i(using)e(a)h(lo)n(wer)g(mixing)e(rate)j(with)e
(high-quality)f(mixing)h(can)h(sound)f(better)h(than)g(a)h(higher)109
3400 y(mixing)23 b(rate)i(with)f(normal)g(quality)-6
b(.)109 3604 y(The)32 b(last)f(setting)g(to)g(consider)h(is)f(the)h
(output)f(mode)g(setting.)51 b(The)32 b(output)e(mode)i(should)e
(normally)h(be)109 3724 y(set)36 b(to)h(a)g(16-bit)f(mode,)j(as)e
(using)f(8-bit)g(modes)g(does)h(not)f(decrease)i(CPU)g(usage,)h(only)d
(sound)g(qual-)109 3844 y(ity)-6 b(.)53 b(If)33 b(the)f(sound)g(card)h
(used)g(doesn')n(t)f(support)g(16-bit)g(output,)h(MID)l(AS)g(will)e
(use)i(8-bit)f(output)f(auto-)109 3965 y(matically)-6
b(.)56 b(Using)34 b(mono)f(output)f(instead)i(of)g(stereo,)i(ho)n(we)n
(v)o(er)l(,)f(can)f(decrease)h(CPU)g(usage)f(by)g(up)g(to)109
4085 y(50\045.)56 b(Therefore,)36 b(if)e(your)f(application)f(does)i
(not)f(use)g(stereo)g(ef)n(fects)h(in)f(its)g(sound)f(output,)j
(consider)109 4206 y(using)29 b(mono)g(output)f(mode)i(instead.)45
b(The)30 b(output)f(mode)g(can)i(be)f(changed)g(by)g(setting)e(the)i
(option)f Fa(MI-)109 4326 y(D)m(AS)p 295 4326 V 35 w(OPTION)p
689 4326 V 36 w(OUTPUTMODE)c Fg(with)f Fa(MID)m(ASsetOption)p
Fg(.)-57 4749 y Fe(4.2)142 b(Using)35 b(-law)g(compr)m(ession)109
5055 y Fg(In)30 b(MID)l(AS)g(Digital)f(Audio)g(System,)h(-la)o(w)g
(samples)f(and)h(streams)f(can)i(be)f(used)f(as)h(an)g(ef)n(fecti)n(v)o
(e)f(com-)109 5175 y(promise)22 b(between)h(CPU)h(and)g(space)f(usage)h
(and)f(sound)f(quality)-6 b(,)22 b(as)h(the)o(y)g(pro)o(vide)f(sound)g
(quality)g(almost)109 5296 y(equi)n(v)n(alent)28 b(to)j(16-bit)e
(samples)h(while)g(using)g(only)g(as)h(much)f(CPU)h(time)f(and)h(space)
g(as)f(8-bit)g(samples.)109 5416 y(This)24 b(section)g(describes)g(ho)n
(w)g(-la)o(w)h(samples)f(are)h(encoded)g(and)g(used)f(with)h(MID)l(AS.)
p eop
%%Page: 20 24
20 23 bop 109 208 a Ff(CHAPTER)25 b(4.)56 b(AD)l(V)-13
b(ANCED)24 b(T)n(OPICS)2165 b Fg(20)-57 473 y Fb(4.2.1)118
b(Encoding)31 b(-law)f(samples)109 741 y Fg(Encoding)i(-la)o(w)g
(samples)g(is)h(simple.)54 b(The)33 b Fc(tools/)f Fg(directory)g(in)h
(the)g(MID)l(AS)g(distrib)n(ution)d(contains)109 861
y(directories)h(for)i(each)g(supported)e(platform,)i(and)f(these)g
(directories)g(contain)g(a)g(program)g(called)g Fc(ulaw)p
Fg(.)109 982 y(This)21 b(program)h(can)g(be)g(used)g(to)f(encode)i
(16-bit)e(samples)g(into)g(-la)o(w)h(samples,)f(and)h(decode)h(-la)o(w)
e(samples)109 1102 y(back)k(to)f(16-bit)g(ones.)30 b(The)25
b(syntax)f(is)h(simple.)k(T)-8 b(o)25 b(encode)g(a)g(16-bit)f(sample)g
(\002le)h(to)g(-la)o(w)-6 b(,)23 b(use:)515 1389 y Fc(ulaw)50
b(e)h(input-file-name)d(output-file-name)109 1675 y Fg(And)24
b(to)h(decode)g(a)g(-la)o(w)f(\002le)h(to)g(a)g(16-bit)f(one,)h(use:)
515 1962 y Fc(ulaw)50 b(d)h(input-file-name)d(output-file-name)109
2248 y Fg(The)28 b(\002les)g(should)f(contain)h(just)f(ra)o(w)h(sample)
g(data,)h(with)e(no)h(headers.)42 b(Stereo)29 b(and)f(mono)f(samples)g
(and)109 2369 y(streams)d(are)h(processed)g(e)o(xactly)f(the)h(same)g
(w)o(ay)-6 b(.)-57 2741 y Fb(4.2.2)118 b(Using)30 b(-law)g(samples)109
3009 y Fg(-la)o(w)f(samples)g(and)h(streams)g(are)g(used)g(just)f(lik)o
(e)g(an)o(y)h(other)g(samples)f(and)g(streams)h(in)f(MID)l(AS)h
(Digital)109 3129 y(Audio)37 b(System.)71 b(Simply)37
b(pass)h(the)g(playback)g(function)f Fa(MID)m(AS)p 2552
3129 30 4 v 36 w(SAMPLE)p 2959 3129 V 35 w(ULA)-9 b(W)p
3256 3129 V 36 w(MONO)38 b Fg(or)h Fa(MI-)109 3250 y(D)m(AS)p
295 3250 V 35 w(SAMPLE)p 701 3250 V 35 w(ULA)-9 b(W)p
998 3250 V 36 w(STEREO)31 b Fg(as)h(the)g(sample)f(type,)h(and)g(e)n(v)
o(erything)e(will)h(w)o(ork)g(normally)-6 b(.)50 b(-la)o(w)109
3370 y(sample)24 b(data)h(can)g(be)g(used)f(for)h(both)f(samples)g(and)
h(streams.)-57 3787 y Fe(4.3)142 b(Using)35 b(ADPCM)g(compr)m(ession)
109 4091 y Fg(ADPCM)29 b(streams)g(pro)o(vide)g(a)h(space-ef)n(fecti)n
(v)o(e)f(w)o(ay)g(of)h(storing)e(long)h(sections)f(of)i(audio)f(with)g
(a)g(f)o(airly)109 4211 y(good)g(sound)g(quality)-6 b(.)45
b(Although)28 b(ADPCM)i(streams)g(ha)n(v)o(e)f(lo)n(wer)h(sound)f
(quality)g(than)g(uncompressed)109 4332 y(16-bit)20 b(ones,)i(the)o(y)f
(do)g(sound)f(better)i(than)f(8-bit)g(ones,)g(and,)h(as)g(the)o(y)e
(only)h(use)g(ef)n(fecti)n(v)o(ely)g(4-bit)f(samples,)109
4452 y(the)o(y)33 b(pro)o(vide)g(1:4)g(compression)g(to)g(the)h(sound.)
58 b(This)33 b(section)g(descibes)h(ho)n(w)f(ADPCM)h(streams)g(are)109
4572 y(encoded)25 b(and)f(used)h(with)f(MID)l(AS)h(Digital)e(Audio)h
(System.)-57 4945 y Fb(4.3.1)118 b(Encoding)31 b(ADPCM)g(str)n(eams)109
5213 y Fg(Encoding)d(ADPCM)i(streams)g(is)f(f)o(airly)h(simple.)44
b(The)30 b Fc(tools/)e Fg(directory)i(in)f(the)h(MID)l(AS)g(distrib)n
(ution)109 5333 y(contains)22 b(directories)i(for)g(each)g(supported)f
(platform,)g(and)g(these)h(directories)f(contain)g(a)h(program)f
(called)109 5453 y Fc(adpcm)p Fg(.)61 b(This)35 b(program)g(can)g(be)h
(used)f(to)g(encode)h(16-bit)e(streams)h(into)f(ADPCM)i(ones,)i(and)d
(decode)109 5574 y(ADPCM)26 b(streams)f(back)h(to)f(16-bit.)32
b(The)26 b(syntax)f(is)g(similar)g(to)g(the)g(-la)o(w)h(encoder)l(,)g
(although)e(a)i(bit)f(more)109 5694 y(complicated.)k(T)-8
b(o)25 b(encode)g(a)g(16-bit)f(stream)h(into)f(ADPCM,)h(use:)p
eop
%%Page: 21 25
21 24 bop 109 208 a Ff(CHAPTER)25 b(4.)56 b(AD)l(V)-13
b(ANCED)24 b(T)n(OPICS)2165 b Fg(21)515 473 y Fc(adpcm)50
b(e)h(input-file-name)d(output-file-name)f(channels)j(frame-length)109
784 y Fg(Where)26 b Fh(channels)g Fg(is)f(the)g(number)g(of)h(channels)
f(in)g(the)g(stream)h(\(1)f(for)h(mono,)e(2)i(for)g(stereo\))f(and)h
Fh(frame-)109 905 y(length)c Fg(the)g(ADPCM)g(frame)g(length)f(in)h
(bytes,)f(including)g(the)g(frame)i(header)-5 b(.)29
b(As)22 b(ADPCM)g(sample)f(data)109 1025 y(is)h(adaptati)n(v)o(e)g
(delta)g(encoded,)h(it)g(is)f(normally)g(impossible)f(to)h(start)h
(decoding)f(an)h(ADPCM)g(stream)g(from)109 1145 y(the)f(middle.)29
b(T)-8 b(o)22 b(get)h(around)f(this)g(problem,)g(MID)l(AS)h(di)n(vides)
e(the)i(ADPCM)g(stream)f(into)g(\223frames\224,)h(and)109
1266 y(is)h(able)h(to)f(start)h(decoding)f(from)g(the)h(be)o(ginning)e
(of)i(an)o(y)f(frame.)109 1469 y(The)h(frame)i(length)e(you)g(should)f
(use)i(depends)f(on)h(the)f(needs)h(of)g(your)f(application.)33
b(If)26 b(your)f(application)109 1590 y(will)h(al)o(w)o(ays)h(play)h
(the)f(streams)g(from)g(be)o(ginning)f(to)h(end,)h(an)o(y)f(v)n(alue)g
(will)f(do)h(\227)h(1024)e(is)h(a)h(reasonable)109 1710
y(choice.)41 b(Ho)n(we)n(v)o(er)l(,)28 b(if)g(stream)g(playback)g(can)g
(start)g(from)g(the)g(middle)f(of)i(the)f(stream,)g(you)g(should)f
(con-)109 1830 y(sider)c(ho)n(w)g(the)g(stream)g(is)g(accessed.)31
b(In)23 b(particular)l(,)h(if)f(the)h(stream)f(is)g(read)h(in)f(blocks)
g(of)g(a)h(set)f(number)g(of)109 1951 y(bytes,)h(the)g(frame)i(length)e
(should)f(be)i(equal)g(to)f(the)h(block)f(size.)109 2154
y(If)e(you)f(wish)f(to)h(mak)o(e)h(the)f(ADPCM)h(frames)g(of)f(a)h(gi)n
(v)o(en)e(length)h(of)g(time,)g(remember)h(that)f(each)h(ADPCM)109
2274 y(sample)k(is)h(4)g(bits.)37 b(Therefore,)29 b(one)e(byte)g(of)g
(ADPCM)h(data)f(will)g(contain)f(data)i(for)f(tw)o(o)g(mono)f(samples)
109 2395 y(or)c(one)h(stereo)g(sample.)29 b(The)23 b(ADPCM)g(frame)g
(header)h(is)e(9)h(bytes)f(long)g(for)h(mono)f(streams)g(and)g(12)h
(bytes)109 2515 y(long)e(for)i(stereo)f(ones.)30 b(Therefore,)24
b(to)e(get)g(59ms)f(long)h(frames)h(for)f(a)h(stereo)f(stream)g(played)
h(at)f(22050Hz,)109 2636 y(the)i(frame)i(length)e(should)f(be)i(453)f
(bytes.)109 2839 y(T)-8 b(o)24 b(decode)h(an)g(ADPCM)g(stream)g(back)g
(to)f(a)i(16-bit)d(one,)i(use:)515 3150 y Fc(adpcm)50
b(d)h(input-file-name)d(output-file-name)f(channels)j(frame-length)109
3462 y Fg(Lik)o(e)38 b(with)h(the)g(-la)o(w)f(encoder/decoder)l(,)43
b(the)c(\002les)h(should)e(contain)g(just)g(ra)o(w)h(sample)g(data,)j
(with)d(no)109 3582 y(headers.)-57 3960 y Fb(4.3.2)118
b(Using)30 b(ADPCM)h(str)n(eams)109 4231 y Fg(ADPCM)k(streams)g(are)h
(used)g(just)e(lik)o(e)h(other)g(streams)g(in)g(MID)l(AS)g(Digital)g
(Audio)f(System.)62 b(Simply)109 4351 y(pass)24 b Fa(MID)m(AS)p
607 4351 30 4 v 36 w(SAMPLE)p 1014 4351 V 35 w(ADPCM)p
1392 4351 V 36 w(MONO)i Fg(or)f Fa(MID)m(AS)p 2151 4351
V 35 w(SAMPLE)p 2557 4351 V 36 w(ADPCM)p 2936 4351 V
36 w(STEREO)g Fg(as)g(the)g(sample)109 4472 y(type)32
b(to)g(the)g(MID)l(AS)h(stream)f(playback)g(functions,)h(and)f(e)n(v)o
(erything)f(will)h(w)o(ork)g(normally)-6 b(.)52 b(ADPCM)109
4592 y(sample)21 b(data)g(can)i(only)e(be)g(used)h(for)g(streams.)29
b(If)22 b(you)f(are)i(feeding)e(the)h(stream)f(data)h(manually)-6
b(,)21 b(ho)n(we)n(v)o(er)l(,)109 4712 y(remember)j(that)h(playback)f
(can)i(only)e(start)g(from)h(the)f(be)o(ginning)f(of)i(an)g(ADPCM)g
(frame.)p eop
%%Page: 22 26
22 25 bop 109 1220 a Fi(Chapter)51 b(5)109 1718 y(Operating)g(system)h
(speci\002c)f(inf)-5 b(ormation)109 2254 y Fg(Although)29
b(the)h(normal)g(MID)l(AS)g(Digital)f(Audio)h(System)g(APIs)g(are)i
(indentical)d(in)h(all)g(supported)g(plat-)109 2374 y(forms,)f(there)h
(are)g(some)e(operating)h(system)f(speci\002c)i(points)e(that)g(should)
g(be)i(noted.)43 b(In)29 b(particular)l(,)h(the)109 2494
y(limitations)22 b(of)j(the)f(MS-DOS)i(operating)e(system)g(mak)o(e)g
(it)h(some)n(what)e(dif)n(\002cult)h(to)g(program)h(under)-5
b(.)-57 2917 y Fe(5.1)142 b(Using)35 b(Dir)m(ectSound)109
3224 y Fg(Be)o(ginning)f(from)i(v)o(ersion)f(0.7,)j(MID)l(AS)e(Digital)
f(Audio)g(System)h(supports)e(DirectSound)i(for)g(sound)109
3344 y(output.)46 b(Although)28 b(most)h(of)i(the)f(time)f(this)h(is)g
(done)g(completely)f(transparently)g(to)h(the)g(user)l(,)i(there)f(are)
109 3464 y(some)24 b(decisions)g(that)g(need)h(to)f(be)h(made)g(in)f
(the)h(initialization)e(phase.)-57 3843 y Fb(5.1.1)118
b(Initialization)109 4113 y Fg(By)35 b(def)o(ault,)h(DirectSound)f
(support)e(in)i(MID)l(AS)g(Digital)e(Audio)h(System)g(is)g(disabled.)60
b(T)-8 b(o)34 b(enable)h(it,)109 4234 y(set)29 b Fa(MID)m(AS)p
551 4234 30 4 v 35 w(OPTION)p 945 4234 V 982 4234 V 72
w(DSOUND)p 1421 4234 V 36 w(MODE)h Fg(to)f(a)g(v)n(alue)g(other)g(than)
g Fa(MID)m(AS)p 2929 4234 V 36 w(DSOUND)p 3369 4234 V
35 w(DISABLED)p Fg(.)109 4354 y(The)24 b(DirectSound)g(mode)g(you)h
(choose)f(depends)g(on)g(the)h(needs)f(of)h(your)f(application,)f(and)i
(the)f(a)n(v)n(ailable)109 4474 y(modes)g(are)h(described)g(in)f
(detail)h(in)f(the)h(ne)o(xt)f(section.)109 4678 y(In)37
b(addition)f(to)h(the)g(DirectSound)f(mode,)k(you)d(also)g(need)g(to)g
(set)g(the)g(windo)n(w)f(handle)g(that)h(MID)l(AS)109
4798 y(will)25 b(in)g(turn)h(pass)g(to)f(DirectSound.)34
b(DirectSound)26 b(uses)g(this)f(windo)n(w)g(handle)g(to)h(determine)f
(the)h(acti)n(v)o(e)109 4918 y(windo)n(w)-6 b(,)30 b(as)g(only)g(the)h
(sound)e(played)i(by)f(the)g(acti)n(v)o(e)g(application)g(will)f(be)i
(heard.)48 b(T)-8 b(o)31 b(set)f(the)h(windo)n(w)109
5039 y(handle,)24 b(simply)f(call)515 5325 y Fc
(MIDASsetOption\(MIDAS_OPTION_DSOUND_)o(HWND,)44 b(\(DWORD\))50
b(hwnd\);)109 5612 y Fg(where)25 b Fh(hwnd)h Fg(is)e(the)h(windo)n(w)e
(handle)i(of)g(your)f(application')-5 b(s)23 b(main)i(windo)n(w)-6
b(.)1949 5943 y(22)p eop
%%Page: 23 27
23 26 bop 109 208 a Ff(CHAPTER)25 b(5.)56 b(OPERA)-11
b(TING)25 b(SYSTEM)g(SPECIFIC)i(INFORMA)-11 b(TION)938
b Fg(23)-57 473 y Fb(5.1.2)118 b(Dir)n(ectSound)32 b(modes)109
744 y Fg(Apart)26 b(from)h Fa(MID)m(AS)p 885 744 30 4
v 35 w(DSOUND)p 1324 744 V 36 w(DISABLED)p Fg(,)f(three)h(dif)n(ferent)
f(DirectSound)h(modes)e(are)j(a)n(v)n(ailable)e(in)109
864 y(MID)l(AS)f(Digital)e(Audio)h(System.)30 b(This)24
b(section)h(describes)f(them)g(in)h(detail.)109 1067
y Fh(MID)m(AS)p 444 1067 V 35 w(DSOUND)p 900 1067 V 36
w(STREAM)p Fg(:)37 b(DirectSound)f(stream)g(mode.)64
b(MID)l(AS)36 b(will)g(play)f(its)h(sound)f(to)h(a)109
1188 y(DirectSound)26 b(stream)h(b)n(uf)n(fer)l(,)h(which)e(will)g
(then)h(be)g(mix)o(ed)f(to)h(the)f(primary)h(b)n(uf)n(fer)g(by)g
(DirectSound.)37 b(If)109 1308 y(the)32 b(DirectSound)g(object)g(hasn')
n(t)g(e)o(xplicitly)e(been)j(set,)h(MID)l(AS)e(will)g(initialize)f
(DirectSound)h(and)h(set)109 1428 y(the)g(primary)f(b)n(uf)n(fer)i
(format)f(to)g(the)g(same)g(as)g(MID)l(AS)g(output)f(format.)56
b(This)33 b(mode)f(allo)n(ws)g(arbitrary)109 1549 y(b)n(uf)n(fer)25
b(length,)g(and)h(possibly)e(smoother)g(playback)i(than)f(primary)g(b)n
(uf)n(fer)h(mode,)f(b)n(ut)h(has)f(a)h(lar)n(ger)g(CPU)109
1669 y(o)o(v)o(erhead.)109 1873 y Fh(MID)m(AS)p 444 1873
V 35 w(DSOUND)p 900 1873 V 36 w(PRIMAR)m(Y)p Fg(:)33
b(DirectSound)i(primary)f(b)n(uf)n(fer)h(mode.)60 b(The)35
b(sound)f(data)h(will)f(be)109 1993 y(played)29 b(directly)f(to)h(the)h
(DirectSound)f(primary)f(b)n(uf)n(fer)-5 b(.)44 b(This)29
b(mode)f(has)i(the)f(smallest)f(CPU)i(o)o(v)o(erhead)109
2113 y(of)f(all)g(a)n(v)n(ailable)g(DirectSound)g(modes,)h(and)f(pro)o
(vides)f(smallest)h(possible)f(latenc)o(y)-6 b(,)29 b(b)n(ut)g(is)g
(not)g(without)109 2234 y(its)22 b(dra)o(wbacks:)30 b(The)23
b(primary)g(b)n(uf)n(fer)g(size)h(is)f(set)g(by)g(the)g(dri)n(v)o(er)l
(,)g(and)g(cannot)g(be)g(changed,)h(so)f(the)g(b)n(uf)n(fer)109
2354 y(size)h(may)h(be)g(limited.)109 2558 y Fh(MID)m(AS)p
444 2558 V 35 w(DSOUND)p 900 2558 V 36 w(FORCE)p 1285
2558 V 35 w(STREAM)p Fg(:)f(This)f(mode)g(beha)n(v)o(es)f(e)o(xactly)h
(lik)o(e)g(the)g(stream)g(mode,)f(e)o(x-)109 2678 y(cept)38
b(that)f(DirectSound)h(usage)g(is)f(forced.)71 b(Normally)-6
b(,)40 b(MID)l(AS)e(will)f(not)h(use)g(DirectSound)f(if)h(it)g(is)109
2798 y(running)26 b(in)g(emulation)g(mode)g(\(as)h(the)g(standard)f(W)l
(indo)n(ws)g(W)-12 b(A)f(VE)26 b(output)g(de)n(vice)g(will)g(pro)o
(vide)g(better)109 2919 y(performance\),)k(so)f(this)f(mode)g(must)g
(be)h(used)f(to)h(force)g(DirectSound)g(usage.)43 b(F)o(orcing)28
b(MID)l(AS)h(to)f(use)109 3039 y(DirectSound)d(in)h(stream)f(mode)g
(will)g(also)h(the)f(applications)g(to)g(use)h(DirectSound)f(themselv)o
(es)g(simulta-)109 3160 y(neously)-6 b(.)109 3363 y(By)21
b(def)o(ault,)g(MID)l(AS)f(an)h(automatical)e(f)o(allback)i(mechanism)e
(for)i(DirectSound)f(modes:)28 b(If)21 b(DirectSound)109
3483 y(support)34 b(is)h(set)g(to)f(primary)h(mode,)i(b)n(ut)e(primary)
g(b)n(uf)n(fer)g(is)g(not)f(a)n(v)n(ailable)h(for)g(writing,)i(MID)l
(AS)e(will)109 3604 y(use)i(stream)g(mode)f(instead.)67
b(And,)40 b(if)d(DirectSound)g(is)g(running)f(in)h(emulation)e(mode,)40
b(MID)l(AS)d(will)109 3724 y(automatically)29 b(use)i(normal)g(W)l
(in32)f(audio)h(services)g(instead.)49 b(This)30 b(w)o(ay)h(it)g(is)g
(possible)e(to)i(simply)f(set)109 3844 y(the)24 b(desired)h
(DirectSound)f(mode,)h(and)f(let)h(MID)l(AS)g(decide)g(the)f(best)h(of)
g(the)f(alternati)n(v)o(es)g(a)n(v)n(ailable.)-57 4223
y Fb(5.1.3)118 b(Buffer)30 b(sizes)109 4493 y Fg(When)25
b(MID)l(AS)h(Digital)f(Audio)g(System)g(is)g(using)g(DirectSound)h
(with)f(proper)h(dri)n(v)o(ers)e(\(ie.)34 b(not)25 b(in)g(emu-)109
4614 y(lation)i(mode\),)i(much)f(smaller)g(b)n(uf)n(fer)h(sizes)f(can)h
(be)g(used)f(than)g(normal.)41 b(Because)30 b(of)e(this,)h(the)f
(Direct-)109 4734 y(Sound)20 b(b)n(uf)n(fer)h(size)g(is)f(set)h(with)f
(a)h(dif)n(ferent)f(option)g(setting)g(\227)g Fa(MID)m(AS)p
2648 4734 V 35 w(OPTION)p 3042 4734 V 37 w(DSOUND)p 3483
4734 V 36 w(B)o(UFLEN)109 4854 y Fg(\227)28 b(from)h(the)g(normal)f
(mixing)g(b)n(uf)n(fer)h(length.)42 b(When)29 b(playing)f(in)h
(emulation)f(mode,)h(MID)l(AS)g(will)f(use)109 4975 y(the)c(normal)g
(mixing)g(b)n(uf)n(fer)h(length,)e(as)i(smaller)f(b)n(uf)n(fers)h(can')
n(t)g(be)g(used)g(as)g(reliably)-6 b(.)109 5178 y(Selecting)35
b(the)g(correct)h(b)n(uf)n(fer)f(size)h(is)e(a)i(compromise)e(between)h
(sound)g(latenc)o(y)f(and)h(reliability:)50 b(the)109
5299 y(longer)37 b(the)h(b)n(uf)n(fer)g(is,)j(the)d(greater)g(latenc)o
(y)g(the)g(sound)f(has,)k(and)d(the)g(longer)f(it)h(tak)o(es)g(the)g
(sound)f(to)109 5419 y(actually)24 b(reach)h(output,)e(b)n(ut)h(the)h
(smaller)e(the)i(b)n(uf)n(fer)f(is)g(made,)h(the)f(more)g(often)h(the)f
(music)g(player)g(needs)109 5539 y(to)g(be)g(called.)31
b(T)-8 b(o)24 b(ensure)g(that)g(there)g(are)h(no)f(breaks)h(in)f(sound)
f(playback,)h(the)g(music)g(player)g(needs)g(to)g(be)p
eop
%%Page: 24 28
24 27 bop 109 208 a Ff(CHAPTER)25 b(5.)56 b(OPERA)-11
b(TING)25 b(SYSTEM)g(SPECIFIC)i(INFORMA)-11 b(TION)938
b Fg(24)109 473 y(called)30 b(at)g(least)g(twice,)h(preferably)g(four)f
(times,)h(during)e(each)i(b)n(uf)n(fer)f(length:)41 b(for)30
b(a)h(100ms)e(b)n(uf)n(fer)l(,)i(for)109 593 y(e)o(xample,)24
b(the)g(sound)g(player)h(needs)g(to)f(be)h(called)g(at)g(least)f(e)n(v)
o(ery)g(50ms,)g(or)h(20)g(times)e(per)i(second.)109 797
y(Although)e(the)i(calling)g(frequenc)o(y)g(requirements)g(don')n(t)f
(seem)h(to)g(be)h(v)o(ery)f(se)n(v)o(ere,)f(in)h(practise)g(trying)g
(to)109 917 y(guarantee)33 b(that)f(a)h(function)f(gets)g(called)h(e)n
(v)o(en)e(20)i(times)e(per)i(second)g(can)g(be)g(dif)n(\002cult.)53
b(The)33 b(realtime)109 1037 y(capabilities)27 b(of)h(the)g(W)l(in32)f
(platform,)h(especially)g(W)l(indo)n(ws)f(95,)h(lea)n(v)o(e)g(a)h(lot)e
(to)h(be)g(desired:)37 b(A)28 b(16-bit)109 1158 y(program)k(or)i
(system)e(service)h(can)h(easily)e(block)h(the)g(system)f(for)h(long)f
(periods)h(of)g(time.)55 b(By)34 b(def)o(ault,)109 1278
y(MID)l(AS)k(uses)h(a)g(separate)g(thread)f(for)h(background)f
(playback,)k(b)n(ut)c(although)g(this)f(thread)i(runs)f(at)h(a)109
1399 y(higher)29 b(priority)g(than)g(the)h(rest)f(of)h(the)g(program,)g
(you)f(may)h(\002nd)g(that)f(using)g(manual)g(polling)f(will)h(help)109
1519 y(you)24 b(get)h(more)f(consistent)g(and)g(reliable)h(sound)f
(playback.)109 1722 y(Unfortunately)g(there)i(is)g(no)f(single)g(b)n
(uf)n(fer)h(size)f(that)g(w)o(orks)h(for)g(e)n(v)o(erybody)-6
b(,)24 b(so)h(some)g(e)o(xperimentation)109 1843 y(will)37
b(be)i(needed.)71 b(The)38 b(def)o(ault)g(MID)l(AS)h(DirectSound)f(b)n
(uf)n(fer)g(size)g(is)g(100ms,)j(which)c(should)h(be)g(a)109
1963 y(reasonable)23 b(compromise)f(for)i(most)e(applications,)g(b)n
(ut,)h(depending)f(on)h(your)g(applications,)f(b)n(uf)n(fer)i(sizes)109
2084 y(at)g(50ms)g(or)h(belo)n(w)f(should)g(be)h(usable.)-57
2462 y Fb(5.1.4)118 b(Using)30 b(other)h(Dir)n(ectSound)h(ser)o(vices)d
(with)h(MID)l(AS)109 2732 y Fg(If)e(necessary)-6 b(,)28
b(it)f(is)g(also)h(possible)e(to)h(use)h(other)f(DirectSound)h
(services)f(simultaneously)e(with)i(MID)l(AS)109 2853
y(Digital)e(Audio)h(System.)36 b(In)27 b(this)f(case,)i(MID)l(AS)e
(should)g(be)h(set)f(to)h(use)f(DirectSound)h(in)f(forced)i(stream)109
2973 y(mode,)c(and)h(the)f(DirectSound)h(object)f(needs)h(to)f(be)h(e)o
(xplicitly)e(gi)n(v)o(en)g(to)i(MID)l(AS)g(before)g(initialization:)515
3260 y Fc(MIDASsetOption{MIDAS_OPTION_DSOUND_)o(OBJECT)o(,)45
b(\(DWORD\))k(ds\);)109 3546 y Fg(Where)32 b Fh(ds)f
Fg(is)g(a)g(pointer)g(to)g(the)g(DirectSound)g(object)g(used,)h
(returned)f(by)g Fa(Dir)l(ectSoundCr)l(eate\(\))p Fg(.)50
b(The)109 3666 y(user)25 b(is)f(also)g(responsible)g(for)h(setting)f
(DirectSound)g(cooperati)n(v)o(e)g(le)n(v)o(el)f(and)i(primary)g(b)n
(uf)n(fer)f(format.)109 3870 y(Although)35 b(this)h(DirectSound)g
(usage)h(is)f(not)g(recommended,)j(it)d(can)h(be)g(used,)j(for)d(e)o
(xample,)h(to)f(play)109 3990 y(music)24 b(with)g(MID)l(AS)h(while)f
(using)g(the)g(DirectSound)h(services)g(directly)f(for)h(playing)f
(sound)g(ef)n(fects.)-57 4368 y Fb(5.1.5)118 b(When)31
b(to)e(use)h(Dir)n(ectSound?)109 4639 y Fg(Although)21
b(DirectSound)i(pro)o(vides)f(a)i(smaller)e(latenc)o(y)h(than)g(the)g
(normal)f(W)l(indo)n(ws)g(sound)g(de)n(vices,)h(and)109
4759 y(possibly)h(smaller)h(CPU)h(o)o(v)o(erhead,)f(it)g(is)g(not)g
(suitable)g(of)h(all)f(applications.)32 b(This)25 b(section)g(gi)n(v)o
(es)f(a)i(quick)109 4880 y(o)o(v)o(ervie)n(w)18 b(on)j(what)f
(applications)f(should)g(use)i(DirectSound,)g(what)f(shouldn')n(t,)g
(and)g(which)h(DirectSound)109 5000 y(mode)j(is)g(most)g(appropriate.)
109 5204 y(The)h(most)g(important)f(dra)o(wback)i(of)g(DirectSound)f
(is,)h(that)f(only)g(the)h(acti)n(v)o(e)e(application)h(gets)g(its)g
(sound)109 5324 y(played.)53 b(While)32 b(this)f(can)i(be)f(useful)g
(with)g(games)f(that)h(run)g(fullscreen,)j(it)c(mak)o(es)h(DirectSound)
g(com-)109 5444 y(pletely)26 b(unusable)h(for)g(applications)f(such)h
(as)h(music)e(players,)h(as)h(background)f(playback)g(is)f(impossible)
109 5565 y(with)d(DirectSound.)30 b(Therefore)25 b(standalone)e(music)g
(player)h(programs)g(should)e(ne)n(v)o(er)i(use)g(DirectSound.)p
eop
%%Page: 25 29
25 28 bop 109 208 a Ff(CHAPTER)25 b(5.)56 b(OPERA)-11
b(TING)25 b(SYSTEM)g(SPECIFIC)i(INFORMA)-11 b(TION)938
b Fg(25)109 473 y(Also,)27 b(if)h(your)f(application)g(does)g(not)h
(bene\002t)g(from)f(the)h(reduced)g(latenc)o(y)f(that)g(DirectSound)h
(pro)o(vides,)109 593 y(it)35 b(is)g(safer)h(not)f(to)g(use)h
(DirectSound.)63 b(The)35 b(DirectSound)h(dri)n(v)o(ers)e(currently)h
(a)n(v)n(ailable)g(are)i(not)e(v)o(ery)109 714 y(mature,)21
b(and)f(the)h(DirectX)f(setup)g(included)g(in)g(the)g(DirectX)h(SDK)g
(is)f(f)o(ar)h(from)f(trouble-free.)30 b(In)21 b(addition,)109
834 y(programs)31 b(using)h(DirectSound)g(need)g(to)g(distrib)n(ute)f
(the)i(DirectX)f(runtime)f(with)h(them,)i(making)d(them)109
954 y(considerably)24 b(lar)n(ger)-5 b(.)109 1158 y(Ho)n(we)n(v)o(er)l
(,)27 b(if)h(you)f(are)h(writing)f(an)h(interacti)n(v)o(e)e
(high-performance)i(application,)f(where)i(strict)e(graphics)109
1278 y(and)32 b(sound)g(synchronization)e(is)i(essential,)i
(DirectSound)e(is)g(clearly)g(the)h(w)o(ay)f(to)g(go.)53
b(F)o(or)33 b(these)f(kind)109 1399 y(of)d(applications,)f(DirectSound)
h(primary)g(b)n(uf)n(fer)g(should)f(be)h(the)g(best)f(solution,)g
(unless)h(there)g(are)h(clear)109 1519 y(reasons)24 b(for)h(using)f
(stream)h(mode.)-57 1897 y Fb(5.1.6)118 b(Dir)n(ectSound)32
b(and)f(multiple)g(windo)o(ws)109 2168 y Fg(When)d(the)g(application)f
(uses)h(DirectSound)h(for)f(sound)g(output,)g(only)f(the)h(sound)g
(from)g(the)g(acti)n(v)o(e)g(win-)109 2288 y(do)n(w)23
b(is)h(played.)31 b(Therefore)25 b(DirectSound)f(requires)h(a)g(windo)n
(w)e(handle)h(to)g(be)h(able)g(to)f(determine)g(which)109
2409 y(windo)n(w)29 b(is)h(acti)n(v)o(e.)47 b(If)31 b(the)f
(application)g(has)g(multiple)f(windo)n(ws)g(that)h(it)g(needs)g(to)g
(acti)n(v)n(ate)g(separately)-6 b(,)109 2529 y(ho)n(we)n(v)o(er)l(,)35
b(this)f(can)h(cause)g(problems.)59 b(DirectSound)34
b(pro)o(vides)g(no)g(documented)g(w)o(ay)g(to)h(change)f(the)109
2649 y(windo)n(w)23 b(handle)i(on)f(the)h(\003y)-6 b(.)109
2853 y(T)e(o)29 b(get)g(around)g(this)f(problem,)h(MID)l(AS)h(Digital)e
(Audio)g(System)h(pro)o(vides)f(tw)o(o)g(functions)g(to)h(suspend)109
2973 y(and)21 b(resume)h(playback:)28 b Fa(MID)m(ASsuspend)20
b Fg(and)i Fa(MID)m(ASr)l(esume)p Fg(.)29 b Fa(MID)m(ASsuspend)20
b Fg(stops)g(all)i(sound)e(play-)109 3093 y(back,)32
b(uninitializes)d(the)h(sound)g(output)g(de)n(vice,)i(and)e(returns)h
(it)f(to)g(the)h(operating)f(system.)47 b Fa(MID)m(ASr)l(e-)109
3214 y(sume)26 b Fg(in)g(turn)h(resumes)f(sound)g(playback)g(after)i
(suspension.)34 b(These)27 b(functions)e(can)j(be)e(used)h(to)f(change)
109 3334 y(the)e(DirectSound)h(windo)n(w)f(handle)g(on)h(the)g(\003y:)
31 b(First)24 b(call)h Fa(MID)m(ASsuspend)p Fg(,)f(set)g(the)h(ne)n(w)g
(windo)n(w)e(han-)109 3455 y(dle,)29 b(and)f(call)g Fa(MID)m(ASr)l
(esume)g Fg(to)g(resume)g(playback.)41 b(This)27 b(will)h(cause)h(a)f
(break)h(to)f(the)g(sound,)g(and)g(the)109 3575 y(sound)c(data)g
(currently)h(b)n(uf)n(fered)g(to)f(the)h(sound)f(output)f(de)n(vice)i
(will)f(be)h(lost.)109 3778 y(Depending)j(on)h(the)g(application,)g(it)
g(may)g(also)g(be)g(possible)f(to)h(get)g(around)g(the)g(DirectSound)g
(multiple)109 3899 y(windo)n(w)j(problem)g(by)h(creating)g(a)h(hidden)e
(parent)i(windo)n(w)e(for)h(all)g(windo)n(ws)f(that)h(will)f(be)h
(used,)i(and)109 4019 y(pass)24 b(the)h(windo)n(w)e(handle)i(of)g(that)
f(parent)h(windo)n(w)e(to)i(DirectSound.)-57 4442 y Fe(5.2)142
b(MS-DOS)35 b(timer)g(callbacks)109 4748 y Fg(This)24
b(section)g(describes)g(ho)n(w)g(MID)l(AS)h(Digital)e(Audio)h(System)h
(uses)f(the)g(MS-DOS)i(system)d(timer)l(,)h(and)109 4869
y(ho)n(w)g(to)g(install)g(user)g(timer)h(callbacks.)30
b(This)24 b(information)g(is)g(not)g(rele)n(v)n(ant)g(in)g(other)h
(operating)f(systems.)-57 5247 y Fb(5.2.1)118 b(Intr)n(oduction)109
5517 y Fg(T)-8 b(o)34 b(be)g(able)h(to)f(play)g(music)g(in)g(the)g
(background)g(in)g(MS-DOS,)h(and)f(to)g(k)o(eep)h(proper)f(tempo)g
(with)g(all)109 5638 y(sound)e(cards,)j(MID)l(AS)e(needs)g(to)f(use)h
(the)g(system)f(timer)g(\(IRQ)i(0,)g(interrupt)e(8\))h(for)h(music)e
(playback.)p eop
%%Page: 26 30
26 29 bop 109 208 a Ff(CHAPTER)25 b(5.)56 b(OPERA)-11
b(TING)25 b(SYSTEM)g(SPECIFIC)i(INFORMA)-11 b(TION)938
b Fg(26)109 473 y(Because)28 b(of)f(this,)g(user)g(programs)g(may)g
(not)g(access)g(the)h(timer)e(directly)-6 b(,)27 b(as)g(this)g(w)o
(ould)f(cause)i(con\003icts)109 593 y(with)23 b(MID)l(AS)h(music)g
(playback.)30 b(As)24 b(the)g(system)f(timer)h(is)g(often)g(used)g(for)
g(controlling)f(program)g(speed,)109 714 y(and)j(running)f(some)h
(tasks)f(in)h(the)g(background,)g(MID)l(AS)g(pro)o(vides)f(a)h
(separate)h(user)f(timer)g(callback)g(for)109 834 y(these)e(purposes.)
30 b(This)24 b(callback)h(should)f(used)g(instead)g(of)h(accessing)g
(the)g(timer)f(hardw)o(are)h(directly)-6 b(.)109 1033
y(The)24 b(callbacks)h(can)g(be)g(ran)g(at)g(an)o(y)f(speed,)h(and)g
(can)g(optionally)e(be)i(synchronized)f(to)h(display)e(refresh.)-57
1401 y Fb(5.2.2)118 b(Using)30 b(timer)g(callbacks)109
1667 y Fg(Basic)21 b(MID)l(AS)g(timer)f(callback)h(usage)g(is)g(v)o
(ery)f(simple:)28 b(Simply)20 b(call)h Fa(MID)m(ASsetT)-5
b(imerCallbac)n(ks)p Fg(,)19 b(pass-)109 1787 y(ing)29
b(it)h(the)h(desired)f(callback)g(rate)h(and)f(pointers)g(to)g(the)g
(callback)h(functions.)46 b(After)31 b(that,)g(the)f(callback)109
1908 y(functions)e(will)h(be)g(called)h(periodically)e(until)h
Fa(MID)m(ASr)l(emo)o(veT)-5 b(imerCallbac)n(ks)28 b Fg(is)h(called.)45
b Fa(MID)m(ASset-)109 2028 y(T)-5 b(imerCallbac)n(ks)22
b Fg(tak)o(es)i(the)f(callback)h(rate)f(in)h(milliHertz)e(\(one)h
(thousandth)f(of)i(a)g(Hertz\))g(units,)e(so)h(to)g(get)109
2149 y(a)i(callback)g(that)f(will)g(be)h(called)g(70)g(times)f(per)h
(second,)g(set)g(the)f(rate)i(to)e(70000.)30 b(The)25
b(callback)g(functions)109 2269 y(need)35 b(to)f(use)h
Fh(MID)m(AS)p 947 2269 30 4 v 35 w(CALL)h Fg(calling)e(con)l(v)o
(ention)f(\()p 2105 2269 V 2141 2269 V 72 w Fc(cdecl)h
Fg(for)h(W)-8 b(atcom)34 b(C,)i(empty)e(for)h(DJGPP\),)109
2389 y(tak)o(e)25 b(no)f(ar)n(guments)g(and)h(return)g(no)f(v)n(alue.)
109 2588 y(F)o(or)j(e)o(xample,)g(this)f(code)i(snippet)e(will)h(use)g
(the)g(timer)g(to)g(increment)f(a)i(v)n(ariable)f Fh(tickCount)h
Fg(100)f(times)109 2708 y(per)e(second:)312 2977 y Fc(void)50
b(MIDAS_CALL)f(TimerCallback\(void\))312 3098 y({)515
3218 y(tickCount++;)312 3338 y(})312 3459 y(...)312 3579
y(MIDASinit\(\);)312 3700 y(...)312 3820 y
(MIDASsetTimerCallbacks\(100000,)c(FALSE,)50 b(&TimerCallback,)e(NULL,)
h(NULL\);)312 3940 y(...)-57 4309 y Fb(5.2.3)118 b(Synchr)n(onizing)32
b(to)e(display)g(r)n(efr)n(esh)109 4575 y Fg(The)38 b(MID)l(AS)g(timer)
f(supports)g(synchronizing)g(the)h(user)g(callbacks)g(to)f(display)g
(refresh)i(under)f(some)109 4695 y(circumstances.)48
b(Display)30 b(synchronization)f(does)i(not)f(w)o(ork)h(when)g(running)
f(under)g(W)l(indo)n(ws)g(95)g(and)109 4815 y(similar)g(systems,)h(and)
g(may)g(f)o(ail)g(in)g(SV)o(GA)g(modes)g(with)f(man)o(y)g(SV)o(GA)h
(cards.)50 b(As)31 b(display)g(synchro-)109 4936 y(nization)22
b(is)g(some)n(what)g(unreliable,)h(and)g(also)f(more)h(dif)n(\002cult)f
(to)h(use)g(than)g(normal)f(callbacks,)h(using)f(it)h(is)109
5056 y(not)h(recommended)g(if)h(a)g(normal)f(callback)h(is)f(suf)n
(\002cient.)109 5255 y(T)-8 b(o)24 b(synchronize)h(the)f(timer)g
(callbacks)h(to)f(screen)i(refresh,)f(use)g(the)g(follo)n(wing)d
(procedure:)109 5453 y(1.)29 b Fh(BEFORE)22 b Fg(MID)l(AS)g(Digital)e
(Audio)g(System)h(is)g(initialized,)f(set)h(up)g(the)g(display)g(mode)f
(you)h(are)h(going)109 5574 y(to)k(use,)g(and)h(get)f(the)g(display)f
(refresh)i(rate)g(corresponding)f(to)g(that)g(mode)g(using)f
Fa(MID)m(ASg)o(etDisplayRe-)109 5694 y(fr)l(eshRate)p
Fg(.)k(If)24 b(your)f(application)f(uses)h(se)n(v)o(eral)g(dif)n
(ferent)g(display)f(modes,)h(you)g(will)f(need)i(to)e(set)i(up)f(each)p
eop
%%Page: 27 31
27 30 bop 109 208 a Ff(CHAPTER)25 b(5.)56 b(OPERA)-11
b(TING)25 b(SYSTEM)g(SPECIFIC)i(INFORMA)-11 b(TION)938
b Fg(27)109 473 y(of)29 b(them)g(in)g(turn)g(and)h(read)g(the)f
(refresh)h(rate)g(for)g(each)g(separately)-6 b(.)44 b(If)30
b Fa(MID)m(ASg)o(etDisplayRefr)l(eshRate)109 593 y Fg(returns)e(zero,)j
(it)d(w)o(as)h(unable)g(to)f(determine)h(the)f(display)g(refresh)i
(rate,)g(and)f(you)f(should)g(use)h(some)f(de-)109 714
y(f)o(ault)h(v)n(alue)h(instead.)46 b(Display)29 b(refresh)i(rates,)g
(lik)o(e)f(timer)f(callback)h(rates,)i(are)f(speci\002ed)f(in)g
(milliHertz)109 834 y(\(1000*Hz\),)24 b(so)h(70Hz)f(refresh)i(rate)f
(becomes)f(70000.)109 1035 y(2.)30 b(Initialize)24 b(MID)l(AS)h
(Digital)f(Audio)g(System)g(etc.)109 1236 y(3.)30 b(Set)25
b(up)g(the)g(display)e(mode)109 1438 y(4.)68 b(Start)37
b(the)g(timer)g(callbacks)g(by)g(calling)g Fa(MID)m(ASsetT)-5
b(imerCallbac)n(ks)p Fg(.)66 b(The)37 b(\002rst)h(ar)n(gument)f(is)f
(the)109 1558 y(refresh)31 b(rate)g(from)f(step)h(1,)h(second)e(ar)n
(gument)g(should)g(be)g(set)h(to)f(TR)l(UE)h(\(to)f(enable)h(display)f
(synchro-)109 1678 y(nization\),)36 b(and)f(the)g(remaining)f(three)h
(ar)n(guments)f(are)i(pointers)e(to)g(the)h Fh(pr)n(eVR)p
Fg(,)h Fh(immVR)e Fg(and)h Fh(inVR)109 1799 y Fg(callback)25
b(functions)e(\(see)j(descriptions)d(belo)n(w\).)109
2000 y(5.)51 b(When)32 b(the)g(callbacks)f(are)i(no)e(longer)h(used,)h
(remo)o(v)o(e)d(them)h(by)h(calling)f Fa(MID)m(ASr)l(emo)o(veT)-5
b(imerCall-)109 2120 y(bac)n(ks)p Fg(.)109 2321 y(When)38
b(you)f(are)i(changing)e(display)g(modes,)j(you)d(must)g(\002rst)h
(remo)o(v)o(e)f(the)g(e)o(xisting)f(timer)i(callbacks,)109
2442 y(change)h(the)h(display)e(modes,)k(and)e(restart)f(the)g
(callbacks)h(with)e(the)i(correct)g(rate.)75 b(Please)40
b(note)f(that)109 2562 y(synchronizing)24 b(the)i(timer)g(to)g(the)g
(screen)g(update)g(tak)o(es)g(a)h(while,)e(and)i(as)f(the)g(timer)f(is)
h(disabled)f(for)i(that)109 2683 y(time)i(it)g(may)h(introduce)f
(breaks)h(in)g(the)g(music.)45 b(Therefore)31 b(we)f(suggest)f(you)h
(handle)g(the)f(timer)h(screen)109 2803 y(synchronization)23
b(before)i(you)g(start)f(playing)g(music.)109 3004 y(If)h(MID)l(AS)g
(is)f(unable)h(to)f(synchronize)h(the)f(timer)h(to)f(display)g
(refresh,)h(it)g(will)f(simply)f(run)i(the)f(callbacks)109
3125 y(lik)o(e)j(normal)h(user)g(callbacks.)41 b(Therefore)29
b(there)f(is)g(no)f(guarantee)i(that)f(the)g(callbacks)g(will)f
(actually)g(get)109 3245 y(synchronized)22 b(to)h(display)-6
b(,)22 b(and)h(your)g(program)f(should)g(not)h(depend)g(on)g(that.)29
b(F)o(or)23 b(e)o(xample,)g(you)f(should)109 3365 y(not)f(use)i(the)f
(timer)f(callbacks)h(for)h(double)e(b)n(uf)n(fering)h(the)g(display)-6
b(,)21 b(as)i Fh(pr)n(eVR)g Fg(might)e(not)g(be)i(called)f(at)g(the)109
3486 y(correct)j(time)f(\227)h(use)f(triple)h(b)n(uf)n(fering)f
(instead)g(to)g(pre)n(v)o(ent)g(possible)f(\003ick)o(er)-5
b(.)-57 3859 y Fb(5.2.4)118 b(The)30 b(callback)h(functions)109
4128 y Fa(MID)m(ASsetT)-5 b(imerCallbac)n(ks)27 b Fg(tak)o(es)i(as)g
(its)g(three)g(last)g(ar)n(guments)f(three)i(pointers)e(to)h(the)g
(timer)f(callback)109 4248 y(functions.)h(These)c(functions)f(are:)109
4449 y Fa(pr)l(eVR\(\))i Fg(\227)h(if)f(the)g(callbacks)g(are)i
(synchronized)d(to)h(display)g(refresh,)h(this)f(function)f(is)h
(called)h(immedi-)109 4570 y(ately)g Fh(bef)n(or)n(e)i
Fg(V)-11 b(ertical)28 b(Retrace)h(starts.)39 b(It)28
b(should)e(be)i(k)o(ept)g(as)f(short)h(as)g(possible,)f(and)g(can)i(be)
f(used)f(for)109 4690 y(changing)j(a)h(couple)g(of)g(hardw)o(are)g(re)o
(gisters)g(\(in)f(particular)h(the)g(display)f(start)g(address\))h(or)g
(updating)f(a)109 4810 y(counter)-5 b(.)109 5012 y Fa(immVR\(\))23
b Fg(\227)g(if)g(the)h(callbacks)f(are)h(synchronized)f(to)g(display)f
(refresh,)i(this)f(function)f(is)h(called)h(immedi-)109
5132 y(ately)g(after)i(V)-11 b(ertical)24 b(Retrace)j(starts.)j(As)24
b Fa(pr)l(eVR\(\))p Fg(,)h(it)g(should)e(be)i(k)o(ept)g(as)f(short)h
(as)g(possible.)109 5333 y Fa(inVR\(\))f Fg(\227)h(if)f(the)h
(callbacks)g(are)g(synchronized)f(to)h(display)f(refresh,)h(this)f
(function)g(is)g(called)h(some)f(time)109 5453 y(later)h(during)e(V)-11
b(ertical)25 b(Retrace.)32 b(It)25 b(can)g(tak)o(e)g(a)g(longer)f(time)
g(than)g(the)h(tw)o(o)f(pre)n(vious)g(functions,)f(and)i(can)109
5574 y(be)d(used,)h(for)g(e)o(xample,)f(for)h(setting)e(the)i(V)o(GA)e
(palette.)30 b(It)23 b(should)e(not)h(tak)o(e)h(longer)f(than)g(a)h
(quarter)g(of)f(the)109 5694 y(time)i(between)h(callbacks)f(though.)p
eop
%%Page: 28 32
28 31 bop 109 208 a Ff(CHAPTER)25 b(5.)56 b(OPERA)-11
b(TING)25 b(SYSTEM)g(SPECIFIC)i(INFORMA)-11 b(TION)938
b Fg(28)109 473 y(If)22 b(the)f(callbacks)g(are)h(not)f(synchronized)g
(to)g(display)f(refresh,)j(the)e(functions)g(are)h(simply)e(called)h
(one)h(after)109 593 y(another)-5 b(.)30 b(The)25 b(same)f(timing)f
(requirements)h(still)g(hold)g(though.)-57 971 y Fb(5.2.5)118
b(Framerate)29 b(contr)n(ol)109 1242 y Fg(DOS)22 b(programs)f
(typically)f(control)h(their)h(framerate)g(by)g(checking)f(the)h(V)-11
b(ertical)22 b(Retrace)h(from)e(the)h(V)o(GA)109 1362
y(hardw)o(are.)64 b(If)36 b(MID)l(AS)f(is)h(playing)e(music)h(in)g(the)
h(background,)i(this)c(is)i(not)f(a)h(good)f(idea,)j(since)d(the)109
1483 y(music)22 b(player)h(can)g(cause)g(the)g(program)g(to)f(miss)g
(retraces.)31 b(Instead,)23 b(the)g(program)f(should)g(set)h(up)g(a)g
(timer)109 1603 y(callback,)35 b(possibly)c(synchronize)h(it)g(to)h
(display)f(refresh,)j(use)e(that)f(callback)h(to)g(increment)f(a)h
(counter)l(,)109 1724 y(and)24 b(w)o(ait)h(until)f(the)g(counter)h
(changes.)109 1927 y(F)o(or)f(e)o(xample:)312 2238 y
Fc(volatile)49 b(unsigned)g(frameCount;)312 2359 y(...)312
2479 y(void)h(MIDAS_CALL)f(PreVR\(void\))312 2600 y({)515
2720 y(frameCount++;)312 2840 y(})312 2961 y(...)312
3081 y(MIDASsetTimerCallbacks\(70000,)c(FALSE,)50 b(&PreVR,)f(NULL,)h
(NULL\);)312 3201 y(...)312 3322 y(while)g(\()g(!quit)g(\))312
3442 y({)464 3563 y(DoFrame\(\);)464 3683 y(oldCount)g(=)g(frameCount;)
464 3803 y(while)g(\()h(frameCount)e(==)h(oldCount)f(\);)312
3924 y(})109 4235 y Fg(Note)21 b(that)g Fh(frameCount)h
Fg(needs)g(to)f(be)g(declared)h Fh(v)o(olatile)p Fg(,)f(otherwise)g
(the)h(compiler)e(might)g(optimize)g(the)109 4355 y(w)o(ait)k
(completely)g(a)o(w)o(ay)-6 b(.)109 4559 y(A)20 b(similar)e(strate)o
(gy)h(can)i(be)f(used)f(to)h(k)o(eep)g(the)g(program)f(run)h(at)g(the)g
(same)f(speed)h(on)g(dif)n(ferent)f(computers.)109 4679
y(Y)-11 b(ou)26 b(can)g(use)g(the)g(frame)h(counter)f(to)g(determine)g
(ho)n(w)f(man)o(y)g(frames)i(rendering)f(the)g(display)f(tak)o(es,)h
(and)109 4800 y(run)e(the)h(mo)o(v)o(ements)d(for)j(all)g(those)f
(frames)h(before)g(rendering)g(the)g(ne)o(xt)f(display)-6
b(.)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
